<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LOZEE 대화</title>
  <link href="https://fonts.googleapis.com/css2?family=KoPub+World+Dotum:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body, html { margin:0; padding:0; font-family:'KoPub World Dotum',sans-serif; background:#f2f2f2; height:100%; display:flex; flex-direction:column; }
    #meter-container { background:#ddd; padding:10px; text-align:center; }
    #volume-meter { width:80%; height:10px; background:#bbb; margin:0 auto; position:relative; border-radius:5px; overflow:hidden; }
    #volume-level { height:100%; width:0%; background:#4caf50; transition:width 0.1s; }
    #chatInterface { flex:1; overflow-y:auto; padding:10px; display:flex; flex-direction:column; gap:5px; }
    .bubble { max-width:70%; padding:10px; border-radius:10px; line-height:1.4; }
    .user { background:#fff; align-self:flex-end; }
    .bot { background:#6078ea; color:#fff; align-self:flex-start; }
    #inputBar { display:flex; padding:10px; background:#eee; }
    #userInput { flex:1; padding:10px; border:1px solid #ccc; border-radius:5px; }
    #sendBtn { margin-left:10px; padding:10px 15px; background:#6078ea; color:#fff; border:none; border-radius:5px; cursor:pointer; }
  </style>
</head>
<body>
  <div id="meter-container">
    <div id="volume-meter"><div id="volume-level"></div></div>
  </div>
  <div id="chatInterface"></div>
  <div id="inputBar">
    <input type="text" id="userInput" placeholder="말을 입력하거나 마이크로 말해보세요." />
    <button id="sendBtn">전송</button>
  </div>
  <script type="module">
    import { getGptResponse, playTTSFromText } from './js/gpt-dialog.js';
    function initVolumeMeter(){ /* 웹 오디오 API로 볼륨 미터 초기화 */ }
    function setupSTTListener(onResult){ /* STT 이벤트 리스너 설정 */ }

    const chat=document.getElementById('chatInterface');
    function appendBubble(text, cls){
      const el=document.createElement('div'); el.className=`bubble ${cls}`; el.textContent=text;
      chat.append(el); chat.scrollTop=chat.scrollHeight;
    }

    document.getElementById('sendBtn').onclick=async()=>{
      const txt=document.getElementById('userInput').value.trim(); if(!txt)return;
      appendBubble(txt,'user'); document.getElementById('userInput').value='';
      const reply=await getGptResponse(txt);
      appendBubble(reply,'bot'); playTTSFromText(reply);
    };

    window.addEventListener('DOMContentLoaded',async()=>{
      initVolumeMeter();
      const name=localStorage.getItem('lozee_username');
      const topic=JSON.parse(localStorage.getItem('selectedTopic')||'{}');
      const welcome=`${name}님, 오늘은 "${topic.displayText||'대화'}" 주제로 시작할게요.`;
      appendBubble(welcome,'bot'); playTTSFromText(welcome);
      setupSTTListener(async(txt)=>{ appendBubble(txt,'user'); const r=await getGptResponse(txt); appendBubble(r,'bot'); playTTSFromText(r); });
    });
  </script>
</body>
</html>
```

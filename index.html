<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LOZEE 시작하기</title>
    <link href="https://fonts.googleapis.com/css2?family=KoPub+World+Dotum:wght@400;700&display=swap" rel="stylesheet">

    <style>
        /* CSS 스타일은 이전과 동일하게 유지됩니다. */
        body, html { margin: 0; padding: 0; font-family: 'KoPub World Dotum', sans-serif; color: #ffffff; height: 100%; overflow: hidden; }
        .step { display: none; flex-direction: column; align-items: center; justify-content: center; padding: 20px; box-sizing: border-box; text-align: center; height: 100vh; width: 100vw; position: absolute; top: 0; left: 0; }
        .step.active { display: flex; }
        .step-background-main { background: linear-gradient(135deg, #6078ea, #a777e3); }
        h2 { font-size: 1.8em; margin-bottom: 20px; color: #fff; line-height: 1.4; }
        p, .info-text { font-size: 1.1em; line-height: 1.6; margin-bottom: 15px; color: #f0f0f0; }
        .error-message { font-weight: bold; font-size: 0.9em; min-height: 1.2em; margin: 5px 0 10px; padding: 5px 8px; color: #ffcdd2; background-color: rgba(0,0,0,0.15); border-radius: 4px; }
        .error-message:empty { display: none; }
        .success-message { font-weight: bold; font-size: 0.9em; min-height: 1.2em; margin: 5px 0 10px; padding: 5px 8px; color: #a5d6a7; background-color: rgba(0,0,0,0.15); border-radius: 4px; }
        .success-message:empty { display: none; }
        input, select { padding: 12px; margin-bottom: 12px; border: 1px solid #bdbdbd; border-radius: 8px; width: 85%; max-width: 350px; font-size: 1em; background: #fdfdfd; box-sizing: border-box; color: #333; }
        button { padding: 13px 28px; background: #fff; color: #6e8efb; border: none; border-radius: 25px; cursor: pointer; font-weight: bold; font-size: 1.05em; margin-top: 20px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15); transition: background-color 0.2s, transform 0.2s; }
        button:hover { background: #f5f5f5; transform: translateY(-2px); }
        button:disabled { background: #e0e0e0; color: #9e9e9e; cursor: not-allowed; transform: none; box-shadow: none; }
        .select-row { display: flex; gap: 10px; justify-content: center; width: 100%; max-width: 500px; margin-bottom: 12px; }
        .select-row select { width: calc(33% - 6px); }
        .terms-box { background-color: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 8px; margin-bottom: 20px; width: 85%; max-width: 450px; text-align: left; }
        .term-item { margin-bottom: 10px; display: flex; align-items: center; }
        .term-item input[type="checkbox"] { width: auto; margin-right: 10px; transform: scale(1.2); }
        .term-item label { font-size: 0.95em; color: #f0f0f0; font-weight: normal; }
        .term-item label a { color: #fff2a8; text-decoration: underline; }
        #stepUserType h2 { font-size: 2em; margin-bottom: 40px; }
        .user-type-options { display: flex; justify-content: center; align-items: center; gap: 30px; width: 100%; max-width: 700px; }
        .user-type-btn { flex: 1; padding: 25px 20px; font-size: 1.2em; min-height: 120px; display: flex; flex-direction: column; justify-content: center; align-items: center; line-height: 1.4; background: rgba(255, 255, 255, 0.9); color: #5f73e0; border: 1px solid rgba(255,255,255,0.3); border-radius: 10px; }
        .btn-subtitle { font-size: 0.8em; font-weight: normal; color: #7b8dda; margin-top: 8px; }
        .user-type-btn:hover { background: #fff; transform: translateY(-1px); }
        .diagnosis-options { display: flex; flex-direction: column; align-items: center; width: 100%; margin-bottom: 20px; max-height: 60vh; overflow-y: auto; padding: 0 10px;}
        .diagnosis-btn, .caregiver-nd-btn { display: block; width: 85%; max-width: 480px; margin-bottom: 10px; padding: 12px; font-size: 1em; background: rgba(255, 255, 255, 0.9); color: #5f73e0; border: 1px solid rgba(255,255,255,0.3); border-radius: 10px; cursor: pointer; font-weight: 500; transition: background-color 0.2s; }
        .diagnosis-btn.active, .caregiver-nd-btn.active { background-color: #FFEB3B; color: #333; border-color: #FBC02D; font-weight:bold;}
        .optional-text { font-size: 0.8em; color: #e0e0e0; font-weight: normal; }
        .secondary-btn { background: #78909c; color: white; margin-top: 10px; }
        .secondary-btn:hover { background: #607d8b; }
        .input-group { margin-bottom: 20px; width: 85%; max-width: 350px; }
        .input-group label { display: block; margin-bottom: 5px; font-size: 1em; color: #f0f0f0; text-align: left; }
        .input-group input, .input-group .select-row { width: 100%; margin-bottom: 0; }
        .radio-option-group { display: flex; justify-content: center; gap: 20px; margin-top: 20px; margin-bottom: 20px; }
        .radio-option-group label { display: flex; align-items: center; font-size: 1em; color: #f0f0f0; cursor: pointer; }
        .radio-option-group input[type="radio"] { appearance: none; width: 20px; height: 20px; border: 2px solid #bdbdbd; border-radius: 50%; margin-right: 8px; transition: background-color 0.2s, border-color 0.2s; cursor: pointer; position: relative; top: 0; }
        .radio-option-group input[type="radio"]:checked { background-color: #6e8efb; border-color: #6e8efb; }
        .radio-option-group input[type="radio"]:checked::after { content: ''; width: 10px; height: 10px; background: white; border-radius: 50%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); }
        /* 진행 바 스타일 */
        .progress-bar { width: 85%; max-width: 350px; height: 10px; background: rgba(255, 255, 255, 0.3); border-radius: 8px; margin: 20px auto; }
        .progress { height: 100%; background: #6e8efb; border-radius: 8px; transition: width 0.2s ease; }
        .progress-text { font-size: 1.1em; color: #f0f0f0; font-family: 'KoPub World Dotum', sans-serif; text-align: center; margin-bottom: 15px; }
        /* 애니메이션 비활성화 관련 클래스는 제거되었습니다. */
        @media (max-width: 600px) {
            h2 { font-size: 1.6em; }
            p, .info-text, .progress-text { font-size: 0.95em; }
            button { font-size: 0.9em; padding: 12px 20px; }
            input, select { padding: 10px; font-size: 0.95em; }
            .user-type-options { flex-direction: column; gap: 15px; }
            .user-type-btn { width: 90%; font-size: 1.05em; }
        }
    </style>
</head>
<body>
    <main>
        <div class="progress-bar">
            <div id="progress" class="progress" style="width: 0%;"></div>
        </div>
        <div class="progress-text" id="progressText"></div>
        
        <section id="stepAuthChoice" class="step step-background-main">
            <h2>LOZEE에 오신 것을 환영합니다!</h2>
            <button id="goToLoginBtn">로그인</button>
            <button id="goToSignUpBtn">회원가입</button>
        </section>

        <section id="stepLogin" class="step step-background-main">
            <h2>로그인</h2>
            <div class="input-group">
                <label for="loginEmail">이메일</label>
                <input type="email" id="loginEmail" placeholder="이메일">
                <div id="loginError" class="error-message"></div>
            </div>
            <div class="input-group">
                <label for="loginPassword">비밀번호</label>
                <input type="password" id="loginPassword" placeholder="비밀번호">
                <div id="loginPasswordError" class="error-message"></div>
            </div>
            <button id="loginBtn">로그인</button>
            <button id="forgotPasswordBtn" class="secondary-btn">비밀번호를 잊으셨나요?</button>
            <button id="linkToSignUpFromLogin" class="secondary-btn">계정이 없으신가요? 회원가입</button>
        </section>

        <section id="stepPasswordReset" class="step step-background-main">
            <h2>비밀번호 재설정</h2>
            <p class="info-text">가입하신 이메일 주소를 입력하시면, 비밀번호 재설정 링크를 보내드립니다.</p>
            <div class="input-group">
                <label for="resetEmail">이메일</label>
                <input type="email" id="resetEmail" placeholder="이메일">
                <div id="resetError" class="error-message"></div>
                <div id="resetSuccess" class="success-message"></div>
            </div>
            <button id="sendResetEmailBtn">재설정 이메일 발송</button>
            <button id="backToLoginBtn" class="secondary-btn">로그인으로 돌아가기</button>
        </section>

        <section id="stepUserType" class="step step-background-main">
            <h2>회원가입</h2>
            <p class="info-text">어떤 역할로 로지를 이용하시겠어요?</p>
            <div class="user-type-options">
                <button class="user-type-btn" data-usertype="directUser">제가 직접 이야기 나눌 거예요<br><span class="btn-subtitle">(신경다양인 당사자)</span></button>
                <button class="user-type-btn" data-usertype="caregiver">제가 보호자예요<br><span class="btn-subtitle">(양육자, 배우자 등)</span></button>
            </div>
            <div id="userTypeError" class="error-message"></div>
            <button id="linkToLoginFromSignUp" class="secondary-btn">이미 계정이 있으신가요? 로그인</button>
        </section>

        <section id="stepTermsAgreement" class="step step-background-main">
            <h2>서비스 이용 약관 및 개인정보처리방침 동의</h2>
            <p class="info-text">로지 서비스 이용을 위해 아래 약관에 동의해주세요.</p>
            <div class="terms-box">
                <div class="term-item">
                    <input type="checkbox" id="agreeTerms" name="agreeTerms">
                    <label for="agreeTerms">(필수) <a href="./terms.html" target="_blank">서비스 이용약관</a>에 동의합니다.</label>
                </div>
                <div class="term-item">
                    <input type="checkbox" id="agreePrivacy" name="agreePrivacy">
                    <label for="agreePrivacy">(필수) <a href="./privacy.html" target="_blank">개인정보처리방침</a>에 동의합니다.</label>
                </div>
                <div class="term-item">
                    <input type="checkbox" id="agreeMarketing" name="agreeMarketing">
                    <label for="agreeMarketing">(선택) 마케팅 정보 수신에 동의합니다.</label>
                </div>
            </div>
            <div id="termsError" class="error-message"></div>
            <button id="submitTermsBtn">다음</button>
            <button id="backToRoleChoiceBtn" class="secondary-btn">이전 (역할 다시 선택)</button>
        </section>

        <section id="stepSignUpEmailPassword" class="step step-background-main">
            <h2>회원가입: 계정 정보 입력</h2>
            <p class="info-text">로지 서비스 이용을 위한 계정 정보를 입력해주세요.<br>이메일은 로그인 ID로 사용되며, 비밀번호 재설정 시 필요합니다.</p>
            <div class="input-group">
                <label for="signUpEmail">이메일</label>
                <input type="email" id="signUpEmail" placeholder="이메일 주소" autocomplete="email">
                <div id="signUpEmailError" class="error-message"></div>
            </div>
            <div class="input-group">
                <label for="signUpPassword">비밀번호 (6자리 이상)</label>
                <input type="password" id="signUpPassword" placeholder="비밀번호 (6자리 이상)" autocomplete="new-password">
                <div id="signUpPasswordError" class="error-message"></div>
            </div>
            <div class="input-group">
                <label for="signUpPasswordConfirm">비밀번호 확인</label>
                <input type="password" id="signUpPasswordConfirm" placeholder="비밀번호 확인" autocomplete="new-password">
                <div id="signUpPasswordConfirmError" class="error-message"></div>
            </div>
            <button id="createAccountBtn">계정 생성 및 인증 메일 발송</button>
        </section>

        <section id="stepEmailVerification" class="step step-background-main">
            <h2>이메일 인증 안내</h2>
            <p class="info-text">가입하신 이메일 주소(<strong id="verificationEmailDisplay"></strong>)로 인증 메일을 보냈습니다.<br>메일을 확인하고 인증 링크를 클릭해주세요.</p>
            <p class="info-text">인증을 완료하셨으면 아래 버튼을 눌러주세요.</p>
            <div id="verificationError" class="error-message"></div>
            <button id="checkVerificationBtn">이메일 인증 완료</button>
            <button id="resendVerificationBtn" class="secondary-btn">인증 메일 다시 보내기</button>
        </section>

        <section id="stepNameBirthSelf" class="step step-background-main">
            <h2 id="nameSelfTitle">정보 입력</h2>
            <div class="input-group">
                <label for="nameSelfInput">로지가 당신을 어떻게 부르면 좋을까요?</label>
                <input type="text" id="nameSelfInput" placeholder="이름">
                <div id="nameSelfError" class="error-message"></div>
            </div>
            <p class="info-text">생년월일을 선택해주세요.<br>만 나이를 계산하여 맞춤형 대화를 제공합니다.</p>
            <div class="select-row">
                <select id="birthYearSelf"></select>
                <select id="birthMonthSelf"></select>
                <select id="birthDaySelf"></select>
            </div>
            <div id="birthSelfError" class="error-message"></div>
            <button id="submitNameBirthSelfBtn">다음</button>
        </section>

        <section id="stepCaregiverNeurodiversity" class="step step-background-main">
            <h2 id="caregiverNdTitle">보호자님에 대해서도 알려주시겠어요? <span class="optional-text">(선택 사항)</span></h2>
            <p class="info-text">본인 또는 관계인(예: 배우자)께서 신경다양성 특성을 가지고 계시다면, 해당하는 항목을 모두 선택해주세요.</p>
            <div class="diagnosis-options">
                <button class="caregiver-nd-btn" data-nd="ASD">1. ASD (자폐 스펙트럼, 아스퍼거증후군, 비언어성학습장애 포함)</button>
                <button class="caregiver-nd-btn" data-nd="LanguageCommunication">2. 언어 의사소통 (사회적 의사소통장애, 언어지연)</button>
                <button class="caregiver-nd-btn" data-nd="ADHD">3. ADHD</button>
                <button class="caregiver-nd-btn" data-nd="Tic">4. 뚜렛, 틱</button>
                <button class="caregiver-nd-btn" data-nd="LearningDisability">5. 학습장애 (난독증, 난산증, 난서증)</button>
                <button class="caregiver-nd-btn" data-nd="SensoryProcessing">6. 감각장애</button>
                <button class="caregiver-nd-btn" data-nd="Other">7. 기타</button>
                <button class="caregiver-nd-btn" data-nd="unsure_or_none">8. 해당 없음 / 잘 모르겠음</button>
            </div>
            <div id="caregiverNdError" class="error-message"></div>
            <button id="submitCaregiverNdBtn">다음 (또는 건너뛰기)</button>
        </section>

        <section id="stepNameBirthFamily" class="step step-background-main">
            <h2 id="nameBirthFamilyTitle">아이(또는 가족)의 정보를 알려주세요.</h2>
            <div class="input-group">
                <label for="nameFamilyInput">로지가 아이(또는 가족)를 어떻게 부르면 좋을까요?</label>
                <input type="text" id="nameFamilyInput" placeholder="이름">
                <div id="nameFamilyError" class="error-message"></div>
            </div>
            <p class="info-text">아이(또는 가족)의 생년월일을 선택해주세요.<br>아이에게 더 적절한 대화 경험을 제공합니다.</p>
            <div class="select-row">
                <select id="birthYearFamily"></select>
                <select id="birthMonthFamily"></select>
                <select id="birthDayFamily"></select>
            </div>
            <div id="birthFamilyError" class="error-message"></div>
            <button id="submitNameBirthFamilyBtn">다음</button>
        </section>

        <section id="stepDiagnosisType" class="step step-background-main">
            <h2 id="diagnosisTitle">특성 이해하기</h2>
            <p class="info-text">해당하는 항목을 모두 선택해주세요. (중복 선택 가능)</p>
            <div class="diagnosis-options">
                <button class="diagnosis-btn" data-diagnosis="ASD">1. ASD (자폐 스펙트럼, 아스퍼거증후군, 비언어성학습장애 포함)</button>
                <button class="diagnosis-btn" data-diagnosis="LanguageCommunication">2. 언어 의사소통 (사회적 의사소통장애, 언어지연)</button>
                <button class="diagnosis-btn" data-diagnosis="ADHD">3. ADHD</button>
                <button class="diagnosis-btn" data-diagnosis="Tic">4. 뚜렛, 틱</button>
                <button class="diagnosis-btn" data-diagnosis="LearningDisability">5. 학습장애 (난독증, 난산증, 난서증)</button>
                <button class="diagnosis-btn" data-diagnosis="SensoryProcessing">6. 감각장애</button>
                <button class="diagnosis-btn" data-diagnosis="Other">7. 기타</button>
                <button class="diagnosis-btn" data-diagnosis="NotApplicable">8. 해당 없음</button>
            </div>
            <div id="diagnosisError" class="error-message"></div>
            <button id="submitDiagnosisBtn">다음</button>
        </section>

        <section id="stepSpecialistDiagnosisCaregiver" class="step step-background-main">
            <h2>전문의 진단 여부</h2>
            <p class="info-text">선택하신 **아이(또는 가족)의** 특성은 전문의에게 진단받은 정보인가요?</p>
            <div class="radio-option-group">
                <label><input type="radio" name="specialistDiagnosisCaregiver" value="true"> 예</label>
                <label><input type="radio" name="specialistDiagnosisCaregiver" value="false"> 아니요</label>
            </div>
            <div id="specialistDiagnosisCaregiverError" class="error-message"></div>
            <button id="submitSpecialistDiagnosisCaregiverBtn">다음</button>
        </section>

        <section id="stepSpecialistDiagnosisDirectUser" class="step step-background-main">
            <h2>전문의 진단 여부</h2>
            <p class="info-text">선택하신 특성은 전문의에게 진단받은 정보인가요?</p>
            <div class="radio-option-group">
                <label><input type="radio" name="specialistDiagnosisDirectUser" value="true"> 예</label>
                <label><input type="radio" name="specialistDiagnosisDirectUser" value="false"> 아니요</label>
            </div>
            <div id="specialistDiagnosisDirectUserError" class="error-message"></div>
            <button id="submitSpecialistDiagnosisDirectUserBtn">다음</button>
        </section>
        
        <section id="stepFinalStart" class="step step-background-main">
            <h2>모든 준비가 끝났어요!</h2>
            <p class="info-text">입력해주신 정보를 바탕으로 로지가 더 의미있는 대화를 나눌 수 있을 거예요.</p>
            <button id="startLozeeConversationBtn">로지와 대화 시작하기</button>
        </section>
    </main>

    <script type="module" src="js/index.js" defer></script>
</body>
</html>
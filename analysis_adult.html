<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ë‚˜ì˜ ëŒ€í™” ì„±ì°° ë³´ê³ ì„œ - LOZEE</title>
    <link
        href="https://fonts.googleapis.com/css2?family=KoPub+World+Dotum:wght@400;700&display=swap"
        rel="stylesheet"
    />
    <link rel="stylesheet" href="gnb.css">
    <link rel="stylesheet" href="css/common.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>

    <style>
        /* analysis.html í˜ì´ì§€ ìŠ¤íƒ€ì¼ê³¼ ê±°ì˜ ë™ì¼í•˜ê²Œ ì‚¬ìš©, ì¼ë¶€ ì¡°ì • ê°€ëŠ¥ */
        :root {
            --primary-color: #6e8efb;
            --secondary-color: #5a7edf;
            --background-color: #f4f6f8; /* í˜ì´ì§€ ë°°ê²½ í†µì¼ */
            --text-color: #333333;
            --card-bg-analysis: #ffffff; /* ì¹´ë“œ ë°°ê²½ í†µì¼ */
            --explanation-bg-analysis: #eef2f7; /* ì„¤ëª… ì˜ì—­ ë°°ê²½ */
            --primary-color-analysis: var(--primary-color); /* h1 ì œëª© ìƒ‰ìƒ */
            --gnb-height: 56px;
        }

        body {
            margin: 0;
            padding-top: var(--gnb-height);
            font-family: 'KoPub World Dotum', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }

        .container {
            max-width:900px;
            margin:25px auto;
            padding:0 25px;
            box-sizing: border-box;
        }
        h1 { /* í˜ì´ì§€ ë©”ì¸ íƒ€ì´í‹€ */
            color: var(--primary-color-analysis);
            text-align: center;
            font-size: 2em;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .share-button-container {
            text-align: center;
            margin-bottom: 30px;
        }
        #reportShareButton {
            background-color: var(--primary-color);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            font-size: 0.95em;
            cursor: pointer;
            transition: background-color 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #reportShareButton:hover {
            background-color: var(--secondary-color);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .assistant-analysis-notice {
            font-size: 0.75em;
            color: #78909c;
            margin-top: -12px;
            margin-bottom: 15px;
            text-align: right;
        }
        .module-explanation {
            font-size:0.9em;
            color:#555;
            margin-bottom:15px;
            padding: 10px;
            background-color: var(--explanation-bg-analysis);
            border-radius: 6px;
            line-height: 1.6;
        }

        h2 { /* ê° ì„¹ì…˜ ì œëª© */
            margin-top:0;
            margin-bottom: 8px;
            font-size:1.5em;
            color:#34495e; /* ë‚¨ìƒ‰ ê³„ì—´ */
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 12px;
        }
        .section {
            background:var(--card-bg-analysis);
            padding:25px;
            margin-top:25px;
            border-radius:12px;
            box-shadow:0 4px 12px rgba(0,0,0,0.08);
        }
        .section p {
            color: #555555;
            line-height: 1.7;
            font-size: 1em;
        }
         .section p strong { /* ê°•ì¡° í…ìŠ¤íŠ¸ */
            color: var(--secondary-color);
            font-weight: bold;
        }
        .feedback {
            margin-top:15px;
            padding:12px 18px;
            border-left-width:5px;
            border-left-style:solid;
            border-radius:8px;
            font-size: 0.95em;
            line-height: 1.6;
        }
        .feedback.negative { background:#ffebee; border-left-color: #c62828; color:#c62828; }
        .feedback.positive { background:#e8f5e9; border-left-color: #2e7d32; color:#2e7d32; }
        .feedback.neutral { background:#eceff1; border-left-color: #546e7a; color:#37474f; }

        #emotionChartContainer {
            position: relative;
            max-width: 450px;
            min-height: 100px;
            height: auto;
            margin: 20px auto 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #emotionChart {
            width:100% !important;
            height:auto !important;
            aspect-ratio: 1 / 1;
            background-color: #fdfdfd;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            padding: 15px;
            box-sizing: border-box;
            display: none; /* JSë¡œ í‘œì‹œ */
        }
        #tagCloud {
            min-height:100px;
            border:1px dashed #cccccc;
            padding:15px;
            margin-top: 20px;
            border-radius: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            justify-content: center;
        }
        .badge { display:inline-block; margin:4px; padding:8px 12px; background:#e8eaf6; color: #3f51b5; border-radius:16px; font-size:0.9em; transition: background-color 0.2s, color 0.2s; font-weight: 500; }
        .badge:hover { background-color: #c5cae9; color: #303f9f; }

        #conversationSummaryContent { /* ëŒ€í™” ìš”ì•½ í‘œì‹œ ì˜ì—­ */
            white-space: pre-wrap; /* ì¤„ë°”ê¿ˆ ë° ê³µë°± ìœ ì§€ */
            line-height: 1.7;
            font-size: 1em;
            color: #444;
            padding: 10px;
            background-color: #f9f9f9;
            border-radius: 8px;
        }

        #situationAlerts { margin-top: 15px; min-height: 50px; }
        #situationAlerts .cognitive-distortion-item { background:#fff3cd; border-left: 5px solid #ffc107; color: #856404; padding: 10px 15px; margin-bottom: 10px; border-radius: 4px; font-size: 0.9em; }
        .footer-assistant-notice { text-align: center; margin-top: 40px; margin-bottom: 20px; font-size: 0.8em; color: #78909c; }
        .methodology-list { list-style-type: none; padding-left: 0; font-size: 0.9em; color: #555; }
        .methodology-list li { margin-bottom: 12px; padding-left: 25px; position: relative; }
        .methodology-list li::before { content: "ğŸ’¡"; color: var(--primary-color); position: absolute; left: 0; font-size: 1.1em; }
        .methodology-list li strong { color: #34495e; }
        .action-button { display: inline-block; margin-top: 15px; background-color: var(--primary-color); color: white; padding: 10px 15px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9em; transition: background-color 0.2s; }
        .action-button:hover { background-color: var(--secondary-color); }

        @media (max-width: 768px) { h1 { font-size: 1.7em; } h2 { font-size: 1.3em; } .section { padding: 20px; } #emotionChartContainer { max-width: 100%; } #emotionChart { aspect-ratio: 4 / 3; } .methodology-list { font-size: 0.85em; } }
        @media (max-width: 480px) { .container { margin: 15px auto; padding: 0 15px; } h1 { font-size: 1.5em; margin-bottom: 25px; } h2 { font-size: 1.2em; } .section { padding: 15px; margin-top: 20px;} .section p { font-size: 0.95em; } .feedback { padding: 10px 15px; font-size: 0.9em;} #emotionChartContainer { max-width: 100%; } #emotionChart { aspect-ratio: 1 / 1; } .badge { font-size: 0.85em; padding: 6px 10px;} .assistant-analysis-notice { font-size: 0.7em; } .methodology-list { font-size: 0.8em; } }
    </style>
</head>
<body>
    <div class="app-container"> </div>
    <nav id="gnb">
        <div id="gnb-title">LOZEE</div>
        <button id="menu-toggle">â˜°</button>
        <div id="dropdown-menu">
          <a href="mypage.html">ğŸ¨ ë‚´ ì •ë³´ ë³´ê¸°</a>
          <a href="index.html">âœ¨ ìƒˆë¡œìš´ ì´ì•¼ê¸° ì‹œì‘!</a>
          <a href="analysis_adult.html">ğŸ“Š ë‚˜ì˜ ëŒ€í™” ì„±ì°°</a> <a href="journal-list.html">ğŸ“– ì´ì•¼ê¸° ëª¨ìŒì§‘</a>
          <a href="https://www.notion.so/maenglionworld/lOZEE-1ebbcdc037cd80fa9c0ddef234121e84?pvs=4" target="_blank">â“ ë¡œì§€ ì‚¬ìš© ì„¤ëª…ì„œ</a>
        </div>
    </nav>

    <div class="container">
        <h1>ë‚˜ì˜ ëŒ€í™” ì„±ì°° ë³´ê³ ì„œ ğŸ§</h1>
        <div class="share-button-container">
            <button id="reportShareButton">ë³´ê³ ì„œ ê³µìœ í•˜ê¸° ğŸ”—</button>
        </div>

        <div class="section" id="conversationSummarySection">
            <h2>ğŸ“ ë¡œì§€ì™€ì˜ ëŒ€í™” ìš”ì•½</h2>
            <p class="assistant-analysis-notice">LOZEE AI ìš”ì•½</p>
            <p class="module-explanation">
                ë¡œì§€ì™€ì˜ ìµœê·¼ ëŒ€í™” ë‚´ìš©ì„ í•œëˆˆì— ë³¼ ìˆ˜ ìˆë„ë¡ ìš”ì•½í–ˆì–´ìš”. ì–´ë–¤ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ì—ˆëŠ”ì§€ ë‹¤ì‹œ í•œë²ˆ ì‚´í´ë³´ì„¸ìš”.
            </p>
            <div id="conversationSummaryContent">
                <p>ìš”ì•½ ë‚´ìš©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
            </div>
        </div>

        <div class="section" id="emotionToneSection">
            <h2>ğŸŒŠ ê°ì • íë¦„ ì‚´í´ë³´ê¸°</h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
            <p class="module-explanation">
                ëŒ€í™” ì¤‘ ë‚˜íƒ€ë‚œ ê°ì •ì˜ ë¶„í¬ë¥¼ í†µí•´ ìì‹ ì˜ ì£¼ëœ ê°ì • ê²½í–¥ì„ íŒŒì•…í•´ë³¼ ìˆ˜ ìˆì–´ìš”. ì–´ë–¤ ê°ì •ë“¤ì´ ì£¼ë¡œ ë‚˜íƒ€ë‚¬ëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”.
            </p>
            <div id="emotionChartContainer"> <canvas id="emotionChart"></canvas>
            </div>
            <p id="empathyMessage" class="feedback" style="display:none; margin-top:15px;"></p>
        </div>

        <div class="section" id="keywordsSection">
            <h2>ğŸ”‘ ë‚˜ì˜ ëŒ€í™” í‚¤ì›Œë“œ</h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
             <p class="module-explanation">
                ëŒ€í™”ì—ì„œ ìì£¼ ì‚¬ìš©í•˜ê±°ë‚˜ ì¤‘ìš”í•˜ê²Œ ë‹¤ë¤„ì§„ í•µì‹¬ ë‹¨ì–´ë“¤ì´ì—ìš”. ì´ í‚¤ì›Œë“œë“¤ì„ í†µí•´ ëŒ€í™”ì˜ ì£¼ìš” ë§¥ë½ì„ íŒŒì•…í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
            <div id="tagCloud"></div>
        </div>

        <div class="section" id="situationSection">
            <h2>ğŸ’¡ í•¨ê»˜ ìƒê°í•´ ë³¼ ì </h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
            <p class="module-explanation">
                ëŒ€í™” ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ ë¡œì§€ê°€ í•¨ê»˜ ë” ê¹Šì´ íƒìƒ‰í•´ë³´ê³  ì‹¶ì€ ìƒê°ì´ë‚˜ ê´€ì ì„ ë°œê²¬í–ˆì–´ìš”. ì•„ë˜ ë‚´ìš©ì„ ì°¸ê³ í•˜ì—¬ ìì‹ ì— ëŒ€í•œ ì´í•´ë¥¼ ë„“í˜€ë³´ì„¸ìš”. ë•Œë¡œëŠ” ìµìˆ™í•œ ìƒê°ì˜ í‹€ì—ì„œ ë²—ì–´ë‚˜ ìƒˆë¡œìš´ ê´€ì ì„ ë°œê²¬í•˜ëŠ” ê²ƒì´ ì„±ì¥ì˜ ê¸°íšŒê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            </p>
            <div id="situationAlerts" style="margin-top:15px;"></div>
            <button id="continueDistortionTalkBtn" class="action-button" style="display:none;">ì´ ì£¼ì œë¡œ ë¡œì§€ì™€ ë” ì´ì•¼ê¸°í•˜ê¸° ğŸ¤”</button>
        </div>

        <div class="section" id="analysisMethodologySection">
             <h2>LOZEEì˜ ë¶„ì„ ë°©ë²•ë¡ </h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
            <ul class="methodology-list">
                <li><strong>Russellì˜ ê°ì • ì›í˜• ëª¨í˜•</strong>: Valence(ì¾Œ-ë¶ˆì¾Œ)ì™€ Arousal(ê°ì„±-ì´ì™„) ì¶•ì„ ê¸°ë°˜ìœ¼ë¡œ ê°ì •ì˜ ìœ„ì¹˜ë¥¼ ë‹¤ì°¨ì›ì ìœ¼ë¡œ ë¶„ì„í•©ë‹ˆë‹¤.</li>
                <li><strong>Plutchikì˜ ê°ì • ë°”í€´</strong>: 8ê°€ì§€ ê¸°ë³¸ ê°ì •ê³¼ ê·¸ ê°•ë„ ë° ìœ ì‚¬ì„±ì„ ë°”íƒ•ìœ¼ë¡œ ë³µí•©ì ì¸ ê°ì • ìƒíƒœë¥¼ ì´í•´í•©ë‹ˆë‹¤.</li>
                <li><strong>Lexicon ê¸°ë°˜ ê°ì„± ë¶„ì„</strong>: í•œêµ­ì–´ ê°ì„± ì‚¬ì „(ì˜ˆ: KOSAC)ì„ í™œìš©í•˜ì—¬ í…ìŠ¤íŠ¸ì˜ ê¸ì •, ë¶€ì •, ì¤‘ë¦½ ê·¹ì„±ì„ íŒë‹¨í•©ë‹ˆë‹¤.</li>
                <li><strong>ë”¥ëŸ¬ë‹ ë¶„ë¥˜ ëª¨ë¸ (BERT/KoBERT)</strong>: ìµœì‹  ìì—°ì–´ ì²˜ë¦¬ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ë¬¸ë§¥ì„ ê³ ë ¤í•œ ê³ ì •ë°€ ê°ì • ê·¹ì„± ë° ì„¸ë¶€ ê°ì •(ì˜ˆ: ê¸°ì¨, ìŠ¬í””, ë¶„ë…¸ ë“±)ì„ ë¶„ë¥˜í•©ë‹ˆë‹¤.</li>
                <li><strong>ì¸ì§€ì™œê³¡ ì´ë¡  (Beckì˜ CBT)</strong>: ì¸ì§€í–‰ë™ì¹˜ë£Œ ì´ë¡ ì— ê¸°ë°˜í•˜ì—¬ ëŒ€í™”ì—ì„œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ ì¸ì§€ì™œê³¡ íŒ¨í„´(ì˜ˆ: í‘ë°±ë…¼ë¦¬, ê³¼ì‰ì¼ë°˜í™” ë“±)ì„ ê°ì§€í•©ë‹ˆë‹¤.</li>
                <li><strong>ëŒ€í™” ì£¼ì œ êµ¬ì¡°í™”</strong>: LOZEE AIì˜ ìì²´ ìƒë‹´ í† í”½ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ëŒ€í™”ì˜ íë¦„ê³¼ ì£¼ìš” ì£¼ì œë¥¼ ì²´ê³„ì ìœ¼ë¡œ íŒŒì•…í•˜ê³  ê´€ë ¨ í”¼ë“œë°±ì„ ì œê³µí•©ë‹ˆë‹¤.</li>
            </ul>
        </div>

        <p class="footer-assistant-notice">ë³¸ ë¶„ì„ì€ ë¡œì§€ AIê°€ ë§ˆìŒì„ ë‹´ì•„ ì¤€ë¹„í–ˆì–´ìš”. ê°œì¸ì ì¸ ì„±ì°°ì„ ìœ„í•œ ì°¸ê³  ìë£Œë¡œ í™œìš©í•´ì£¼ì„¸ìš”.</p>
    </div>

    <script type="module">
        let chartLibraryInitialized = false;

        function initializeChartJsGlobal() {
            // ... (ê¸°ì¡´ analysis.htmlì˜ initializeChartJsGlobal í•¨ìˆ˜ì™€ ë™ì¼í•˜ê²Œ ì‚¬ìš©) ...
            try {
                if (typeof Chart !== 'undefined' && Chart) {
                    Chart.defaults.color = '#333';
                    Chart.defaults.borderColor = '#e0e0e0';
                    Chart.defaults.font.family = "'KoPub World Dotum', sans-serif";
                    Chart.defaults.font.size = 12;
                    console.log("Adult Analysis Page: Chart.js(UMD) ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¸ì‹ë˜ê³  ê¸°ë³¸ê°’ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
                    chartLibraryInitialized = true;
                    return true;
                } else {
                    console.error("Adult Analysis Page: Chart.js(UMD) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                    const emotionChartContainer = document.getElementById('emotionChartContainer');
                    if (emotionChartContainer) {
                        emotionChartContainer.innerHTML = '<p style="text-align:center; color:red; padding:20px;">ì°¨íŠ¸ ê¸°ëŠ¥ì— ë¬¸ì œê°€ ìˆì–´ìš”. ğŸ˜­<br>í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ë³´ì„¸ìš”.</p>';
                    }
                    return false;
                }
            } catch (error) {
                console.error("Adult Analysis Page: Chart.js(UMD) ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜!", error);
                return false;
            }
        }

        // --- í˜ì´ì§€ ì ‘ê·¼ ê¶Œí•œ í™•ì¸ (15ì„¸ ì´ìƒ) ---
        const ADULT_ANALYSIS_MIN_AGE = 15;
        const currentUserAgeForAccessCheck = parseInt(localStorage.getItem('lozee_userage'), 10);

        if (isNaN(currentUserAgeForAccessCheck) || currentUserAgeForAccessCheck < ADULT_ANALYSIS_MIN_AGE) {
            console.warn(`Adult Analysis Page: ì ‘ê·¼ ì œí•œ. ì‚¬ìš©ì ë‚˜ì´(${currentUserAgeForAccessCheck})ê°€ ${ADULT_ANALYSIS_MIN_AGE}ì„¸ ë¯¸ë§Œì…ë‹ˆë‹¤. analysis.htmlë¡œ ë¦¬ë””ë ‰ì…˜í•©ë‹ˆë‹¤.`);
            // 15ì„¸ ë¯¸ë§Œ ì‚¬ìš©ìëŠ” ê¸°ì¡´ analysis.htmlë¡œ ë³´ëƒ…ë‹ˆë‹¤.
            // ë˜ëŠ” "ì´ìš©í•  ìˆ˜ ì—†ëŠ” í˜ì´ì§€ì…ë‹ˆë‹¤"ë¼ëŠ” ë©”ì‹œì§€ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
            window.location.replace('analysis.html'); 
            // window.location.replaceë¥¼ ì‚¬ìš©í•˜ì—¬ ë’¤ë¡œ ê°€ê¸°ë¡œ ì´ í˜ì´ì§€ì— ë‹¤ì‹œ ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤.
            // ë§Œì•½ analysis.htmlì´ ì—†ë‹¤ë©´, index.htmlì´ë‚˜ ë‹¤ë¥¸ ì ì ˆí•œ í˜ì´ì§€ë¡œ ë³´ëƒ…ë‹ˆë‹¤.
        } else {
            // 15ì„¸ ì´ìƒ ì‚¬ìš©ìë§Œ ì•„ë˜ì˜ ë‚˜ë¨¸ì§€ ì½”ë“œë¥¼ ì‹¤í–‰í•©ë‹ˆë‹¤.
            console.log("Adult Analysis Page: ì ‘ê·¼ í—ˆìš©. ì‚¬ìš©ì ë‚˜ì´:", currentUserAgeForAccessCheck);

            let chartLibraryInitialized = false;

            function initializeChartJsGlobal() {
                // ... (ê¸°ì¡´ initializeChartJsGlobal í•¨ìˆ˜ ë‚´ìš©) ...
                try {
                    if (typeof Chart !== 'undefined' && Chart) {
                        Chart.defaults.color = '#333';
                        Chart.defaults.borderColor = '#e0e0e0';
                        Chart.defaults.font.family = "'KoPub World Dotum', sans-serif";
                        Chart.defaults.font.size = 12;
                        console.log("Adult Analysis Page: Chart.js(UMD) ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì¸ì‹ë˜ê³  ê¸°ë³¸ê°’ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤.");
                        chartLibraryInitialized = true;
                        return true;
                    } else {
                        console.error("Adult Analysis Page: Chart.js(UMD) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                        const emotionChartContainer = document.getElementById('emotionChartContainer');
                        if (emotionChartContainer) {
                            emotionChartContainer.innerHTML = '<p style="text-align:center; color:red; padding:20px;">ì°¨íŠ¸ ê¸°ëŠ¥ì— ë¬¸ì œê°€ ìˆì–´ìš”. ğŸ˜­<br>í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ë³´ì„¸ìš”.</p>';
                        }
                        return false;
                    }
                } catch (error) {
                    console.error("Adult Analysis Page: Chart.js(UMD) ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜!", error);
                    return false;
                }
            }
        

        document.addEventListener('DOMContentLoaded', () => {
            console.log("Adult Analysis Page: DOMContentLoaded ì´ë²¤íŠ¸ ì‹œì‘");
            const chartJsIsReady = initializeChartJsGlobal();


            // --- DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° ---
            const conversationSummaryContentEl = document.getElementById('conversationSummaryContent');
            const emotionChartEl = document.getElementById('emotionChart');
            const emotionChartContainerEl = document.getElementById('emotionChartContainer');
            const empathyMessageEl = document.getElementById('empathyMessage');
            const tagCloudEl = document.getElementById('tagCloud'); // í‚¤ì›Œë“œ ì„¹ì…˜ìš©

            
            // const patternDashboardEl = document.getElementById('patternDashboard'); // íŒ¨í„´ ì„¹ì…˜ì´ ë³„ë„ë¡œ ì—†ìœ¼ë¯€ë¡œ ì£¼ì„ ì²˜ë¦¬ ë˜ëŠ” í™œìš© ë°©ì•ˆ ì¬ê³ 
            const situationAlertsEl = document.getElementById('situationAlerts');
            const continueDistortionTalkBtn = document.getElementById('continueDistortionTalkBtn');
            const reportShareButton = document.getElementById('reportShareButton');
            const containerEl = document.querySelector('.container');




         // --- ë°ì´í„° ë¡œë“œ ---
                // userAgeëŠ” í˜ì´ì§€ ìƒë‹¨ì—ì„œ ì´ë¯¸ currentUserAgeForAccessCheckë¡œ ê°€ì ¸ì™”ìœ¼ë¯€ë¡œ ì¬í™œìš© ê°€ëŠ¥
                const userAge = currentUserAgeForAccessCheck; 
                console.log("Adult Analysis Page - User Age (confirmed for access):", userAge);

                const analysisDataString = localStorage.getItem('lozee_conversation_analysis');
                let analysisResults = null;

                if (!analysisDataString) {
                    console.warn("Adult Analysis Page: localStorageì— 'lozee_conversation_analysis' ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.");
                    if (containerEl) {
                        document.querySelectorAll('.section:not(#analysisMethodologySection)').forEach(sec => {
                            if(sec) sec.style.display = 'none';
                        });
                        if (!containerEl.querySelector('.no-data-message')) {
                            const noDataMsgDiv = document.createElement('div');
                            noDataMsgDiv.className = 'feedback neutral no-data-message';
                            noDataMsgDiv.style.textAlign = 'center';
                            noDataMsgDiv.style.marginTop = '20px';
                            noDataMsgDiv.innerHTML = '<h2>ì•„ì§ ë¡œì§€ì™€ ì¶©ë¶„í•œ ëŒ€í™”ë¥¼ ë‚˜ëˆ„ì§€ ì•Šìœ¼ì…¨êµ°ìš”! ğŸ˜®</h2><p>ë¨¼ì € ë¡œì§€ì™€ í¸ì•ˆí•˜ê²Œ ëŒ€í™”í•˜ì‹  í›„, ëŒ€í™” ì„±ì°° ë³´ê³ ì„œë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.</p>';
                            const pageTitleH1 = containerEl.querySelector('h1');
                            if (pageTitleH1 && pageTitleH1.nextElementSibling) {
                                pageTitleH1.nextElementSibling.insertAdjacentElement('afterend', noDataMsgDiv);
                            } else if (pageTitleH1) {
                                containerEl.insertBefore(noDataMsgDiv, pageTitleH1.nextSibling);
                            } else {
                                containerEl.insertBefore(noDataMsgDiv, containerEl.firstChild);
                            }
                        }
                    }
                    return;
                }

                try {
                    const fullAnalysis = JSON.parse(analysisDataString);
                    analysisResults = fullAnalysis.results;
                } catch (e) {
                    console.error("ì €ì¥ëœ ë¶„ì„ ê²°ê³¼ íŒŒì‹± ì˜¤ë¥˜:", e);
                    if (containerEl) containerEl.innerHTML = '<h1>ì•—! ë¶„ì„ ê²°ê³¼ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ë¬¸ì œê°€ ìƒê²¼ì–´ìš” ğŸ˜¥</h1><p style="text-align:center;">ì´ì „ ëŒ€í™”ë¡œ ëŒì•„ê°€ê±°ë‚˜, ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>';
                    return;
                }

                if (!analysisResults) {
                    console.warn("Adult Analysis Page: íŒŒì‹± í›„ analysisResults ê°ì²´ê°€ nullì…ë‹ˆë‹¤.");
                    if (conversationSummaryContentEl) conversationSummaryContentEl.innerHTML = '<p>ë¶„ì„ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }


          // --- ê° ë¶„ì„ ì„¹ì…˜ ë Œë”ë§ ---
                // 1. ë¡œì§€ì™€ì˜ ëŒ€í™” ìš”ì•½
                if (conversationSummaryContentEl) {
                    if (analysisResults.conversationSummary) {
                        conversationSummaryContentEl.textContent = analysisResults.conversationSummary;
                    } else {
                        conversationSummaryContentEl.innerHTML = '<p>ëŒ€í™” ìš”ì•½ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë¡œì§€ì™€ ë” ë§ì€ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ ë³´ì„¸ìš”.</p>';
                    }
                }

                // 2. ê°ì • íë¦„ ì‚´í´ë³´ê¸°
                const emotionToneSection = document.getElementById('emotionToneSection');
                if (emotionToneSection) {
                    if (chartJsIsReady && analysisResults.emotionToneData && Object.keys(analysisResults.emotionToneData).length > 0) {
                        if(emotionChartEl) emotionChartEl.style.display = 'block';
                        if(emotionChartContainerEl && emotionChartContainerEl.querySelector('.no-chart-message')) {
                             emotionChartContainerEl.querySelector('.no-chart-message').remove();
                        }
                        renderEmotionChart('emotionChart', analysisResults.emotionToneData);
                        if(empathyMessageEl) displayEmpathyMessage(analysisResults.emotionToneData);
                    } else {
                        if(emotionChartEl) emotionChartEl.style.display = 'none';
                        if(emotionChartContainerEl && !emotionChartContainerEl.querySelector('.no-chart-message')) {
                            const noDataMsg = document.createElement('p');
                            noDataMsg.textContent = chartJsIsReady ? "ëŒ€í™”ë¥¼ í†µí•´ ë‚˜íƒ€ë‚œ ê°ì •ë“¤ì„ ì´ê³³ì—ì„œ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ˜Š" : "ì°¨íŠ¸ ê¸°ëŠ¥ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆì–´ìš”. ğŸ˜¥";
                            noDataMsg.style.textAlign = 'center'; noDataMsg.style.color = '#888'; noDataMsg.classList.add('no-chart-message');
                            emotionChartContainerEl.appendChild(noDataMsg);
                        }
                        if(empathyMessageEl) { empathyMessageEl.textContent = "ëŒ€í™”ì—ì„œ ë‚˜íƒ€ë‚œ ì£¼ëœ ê°ì •ì„ íŒŒì•…í•˜ê¸° ìœ„í•´ ë¡œì§€ì™€ ë” ê¹Šì€ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ ë³´ì„¸ìš”."; empathyMessageEl.className = 'feedback neutral'; empathyMessageEl.style.display = 'block'; }
                    }
                }

                // 3. ë‚˜ì˜ ëŒ€í™” í‚¤ì›Œë“œ
                const keywordsSection = document.getElementById('keywordsSection');
                if (keywordsSection && tagCloudEl) {
                    if (analysisResults.keywords && analysisResults.keywords.length > 0) {
                        const weightedKeywords = analysisResults.keywords.map(kw => ({ text: kw, weight: Math.floor(5 + Math.random() * 10) }));
                        renderTagCloud('tagCloud', weightedKeywords);
                    } else {
                        tagCloudEl.innerHTML = '<p style="text-align:center; color:#888;">ëŒ€í™”ì˜ ì£¼ìš” í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤. ì¶©ë¶„í•œ ëŒ€í™”ê°€ í•„ìš”í•´ìš”.</p>';
                    }
                }

                // 4. í•¨ê»˜ ìƒê°í•´ ë³¼ ì  (ì¸ì§€ì™œê³¡)
                const situationSection = document.getElementById('situationSection');
                if (situationSection) {
                    if (analysisResults.cognitiveDistortions && analysisResults.cognitiveDistortions.length > 0) {
                        if(situationAlertsEl) alertCognitiveDistortions('situationAlerts', analysisResults.cognitiveDistortions);
                        if (continueDistortionTalkBtn) {
                            continueDistortionTalkBtn.style.display = 'inline-block';
                            continueDistortionTalkBtn.onclick = () => {
                                createImprovementPlanIfNeeded(analysisResults, userAge);
                                const plan = (JSON.parse(localStorage.getItem('lozee_improvement_plans') || '[]')).find(p => p.type === 'cognitive_distortion' && analysisResults.cognitiveDistortions.includes(p.details));
                                if (plan) {
                                    const continueTopicData = {
                                        type: 'continue_improvement_plan',
                                        planType: plan.type,
                                        details: plan.topic || plan.details,
                                        prompt: plan.promptForContinuation || `"${plan.details}" ìƒê° íŒ¨í„´ì— ëŒ€í•´ ë” ì´ì•¼ê¸° ë‚˜ëˆ ë³¼ê¹Œìš”?`
                                    };
                                    localStorage.setItem('lozee_talk_init_topic', JSON.stringify(continueTopicData));
                                    window.location.href = 'talk.html';
                                } else {
                                    alert("ì´ì–´ê°ˆ ì•½ì† ì •ë³´ë¥¼ ìƒì„±í•˜ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
                                }
                            };
                        }
                    } else {
                        if(situationAlertsEl) situationAlertsEl.innerHTML = '<p style="text-align:center; color:#888;">ëŒ€í™”ì—ì„œ íŠ¹ë³„íˆ ì¹˜ìš°ì¹œ ìƒê° ìŠµê´€ì€ ë°œê²¬ë˜ì§€ ì•Šì•˜ì–´ìš”. ê· í˜• ì¡íŒ ì‹œê°ì„ ì˜ ìœ ì§€í•˜ê³  ê³„ì‹œëŠ”êµ°ìš”! ğŸ‘</p>';
                        if(continueDistortionTalkBtn) continueDistortionTalkBtn.style.display = 'none';
                    }
                }
                
                // ê³µìœ  ë²„íŠ¼ ë¡œì§
                if(reportShareButton) {
                    reportShareButton.onclick = () => {
                        const reportId = (localStorage.getItem('lozee_username') || 'user') + "_" + new Date().getTime();
                        const shareableLink = `${window.location.origin}${window.location.pathname}?report_id=${reportId}`; 

                        if (navigator.clipboard && navigator.clipboard.writeText) {
                            navigator.clipboard.writeText(shareableLink)
                                .then(() => {
                                    alert('ì„±ì°° ë³´ê³ ì„œ ê³µìœ  ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n' + shareableLink + '\n(ì‹¤ì œ ê³µìœ ë¥¼ ìœ„í•´ì„œëŠ” ë³´ê³ ì„œ ì €ì¥ ê¸°ëŠ¥ì´ í•„ìš”í•©ë‹ˆë‹¤.)');
                                })
                                .catch(err => {
                                    console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                                    alert('ë§í¬ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”:\n' + shareableLink);
                                });
                        } else {
                            prompt('ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•˜ì—¬ ê³µìœ í•˜ì„¸ìš” (ì‹¤ì œ ê³µìœ  ê¸°ëŠ¥ì€ ì¶”ê°€ êµ¬í˜„ í•„ìš”):', shareableLink);
                        }
                    };
                }
                 // ë¶„ì„ ê²°ê³¼ ë¡œë“œ í›„, "ë¡œì§€ì™€ì˜ ì•½ì†" ìƒì„±
                if (analysisResults) {
                     createImprovementPlanIfNeeded(analysisResults, userAge);
                }
            }); // DOMContentLoaded ë

            // --- ë°ì´í„° ë Œë”ë§ í•¨ìˆ˜ë“¤ ---
            // (renderTagCloud, alertCognitiveDistortions, renderEmotionChart, displayEmpathyMessageëŠ” ì—¬ê¸°ì— ìœ„ì¹˜)
            // ... (ì´ì „ ë‹µë³€ì—ì„œ ì œê³µëœ í•¨ìˆ˜ë“¤) ...
            function renderTagCloud(elementId, tags) { const cloudEl = document.getElementById(elementId); if(!cloudEl) return; if(tags && tags.length > 0) { cloudEl.innerHTML = tags.map(tag => { const size = 0.8 + ( (tag.weight || 5) / 15); const opacity = Math.max(0.5, (tag.weight || 5) / 10); return `<span class="badge" style="opacity:${opacity}; font-size:${size}em;">${tag.text}</span>`; }).join(''); } else { cloudEl.innerHTML = '<p style="text-align:center; color:#888;">ëŒ€í™”ì˜ ì£¼ìš” í‚¤ì›Œë“œë¥¼ ì¶”ì¶œí•˜ê³  ìˆìŠµë‹ˆë‹¤.</p>'; } }
            function alertCognitiveDistortions(elementId, distortions) { const alertEl = document.getElementById(elementId); if(!alertEl) return; if(distortions && distortions.length > 0) { alertEl.innerHTML = distortions.map(d => `<p class="cognitive-distortion-item">${d}</p>`).join(''); } else { alertEl.innerHTML = '<p style="text-align:center; color:#888;">íŠ¹ë³„íˆ í•œìª½ìœ¼ë¡œ ê¸°ìš¸ì–´ì§„ ìƒê° ì—†ì´ ì´ì•¼ê¸°ë¥¼ ì˜ ë‚˜ëˆ„ê³  ìˆêµ¬ë‚˜! ì˜í–ˆì–´! ğŸ‘</p>';} }
            function renderEmotionChart(canvasId, emotionData) {
                 if (!chartLibraryInitialized || typeof Chart === 'undefined') { 
                    console.error("Chart.jsê°€ ì¤€ë¹„ë˜ì§€ ì•Šì•„ ì°¨íŠ¸ë¥¼ ê·¸ë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."); 
                    const chartContainer = document.getElementById('emotionChartContainer');
                    if(chartContainer && !chartContainer.querySelector('.no-chart-library-message')) {
                         const noLibMsg = document.createElement('p');
                         noLibMsg.textContent = "ì°¨íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ë¬¸ì œê°€ ë°œìƒí–ˆì–´ìš”. ğŸ˜¥";
                         noLibMsg.style.textAlign = 'center'; noLibMsg.style.color = 'red';
                         noLibMsg.classList.add('no-chart-library-message');
                         chartContainer.innerHTML = ''; 
                         chartContainer.appendChild(noLibMsg);
                    }
                    return; 
                }
                const ctx = document.getElementById(canvasId)?.getContext('2d');
                const chartContainer = document.getElementById('emotionChartContainer'); 
                const chartEl = document.getElementById(canvasId);


            if (!ctx) { /* ... ì˜¤ë¥˜ ì²˜ë¦¬ ... */ return; }
                if (!emotionData || Object.keys(emotionData).length === 0) { /* ... ë°ì´í„° ì—†ìŒ ì²˜ë¦¬ ... */ return; }
                
                if(chartContainer) { 
                    const existingMsg = chartContainer.querySelector('.no-chart-message') || chartContainer.querySelector('.no-chart-library-message');
                    if (existingMsg) existingMsg.remove();
                    if(chartEl) chartEl.style.display = 'block';
                }

                const existingChart = Chart.getChart(ctx); 
                if (existingChart) { existingChart.destroy(); }

                const emotionColors = { 'ê¸°ì¨': 'rgba(255, 205, 86, 0.7)','ìŠ¬í””': 'rgba(54, 162, 235, 0.7)','ë¶„ë…¸': 'rgba(255, 99, 132, 0.7)','ë¶ˆì•ˆ': 'rgba(153, 102, 255, 0.7)','ìˆ˜ì¹˜': 'rgba(255, 159, 64, 0.7)','ì¤‘ë¦½': 'rgba(201, 203, 207, 0.7)'};
                const labels = Object.keys(emotionData);
                const dataValues = Object.values(emotionData);
                const backgroundColors = labels.map(label => emotionColors[label] || 'rgba(100, 100, 100, 0.7)');

                new Chart(ctx, { 
                    type: 'doughnut', 
                    data: { 
                        labels: labels, 
                        datasets: [{ label: 'ë‚˜ì˜ ë§ˆìŒ ë¹„ìœ¨', data: dataValues, backgroundColor: backgroundColors, borderColor: '#ffffff', borderWidth: 2 }] 
                    }, 
                    options: { 
                        responsive: true, maintainAspectRatio: false, 
                        plugins: { 
                            legend: { position: 'bottom', labels: { color: Chart.defaults.color, font: { family: Chart.defaults.font.family, size: 11 }, padding: 15 } }, 
                            tooltip: { titleFont: { family: Chart.defaults.font.family }, bodyFont: { family: Chart.defaults.font.family } } 
                        } 
                    } 
                });
            }
            function displayEmpathyMessage(emotionData) {
                const empathyMessageEl = document.getElementById('empathyMessage');
                if (!empathyMessageEl || !emotionData || Object.keys(emotionData).length === 0) {
                    if (empathyMessageEl) empathyMessageEl.style.display = 'none';
                    return;
                }

                const entries = Object.entries(emotionData).filter(([, score]) => score > 0); 
                if (entries.length === 0) { 
                     empathyMessageEl.textContent = 'ëŒ€í™”ì—ì„œ ë‹¤ì–‘í•œ ê°ì •ë“¤ì„ íƒìƒ‰í•´ë³¼ ìˆ˜ ìˆì–´ìš”. ì–´ë–¤ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ê³  ì‹¶ìœ¼ì‹ ê°€ìš”?';
                     empathyMessageEl.className = 'feedback neutral';
                     empathyMessageEl.style.display = 'block';
                     return;
                }

                entries.sort((a, b) => b[1] - a[1]); 
                const [dominantEmotion, score] = entries[0];
                let msg = '';
                let sentimentClass = 'neutral';

                if (score > 0.3) { 
                    switch (dominantEmotion) {
                        case 'ê¸°ì¨': msg = `ëŒ€í™”ì—ì„œ <strong>ê¸ì •ì ì´ê³  ì¦ê±°ìš´</strong> ê°ì •ì´ ë§ì´ ëŠê»´ì§€ë„¤ìš”. ì¢‹ì€ ì¼ì´ ìˆìœ¼ì…¨ë‚˜ ë´ìš”!`; sentimentClass = 'positive'; break;
                        case 'ìŠ¬í””': msg = `ë§ˆìŒì´ ë‹¤ì†Œ ê°€ë¼ì•‰ê±°ë‚˜ <strong>ì†ìƒí•œ ë¶€ë¶„</strong>ì´ ìˆìœ¼ì…¨ë˜ ê²ƒ ê°™ì•„ìš”. ê´œì°®ìœ¼ì‹œë‹¤ë©´ ë” ìì„¸íˆ ì´ì•¼ê¸°í•´ì£¼ì…”ë„ ì¢‹ì•„ìš”.`; sentimentClass = 'negative'; break;
                        case 'ë¶„ë…¸': msg = `í˜¹ì‹œ <strong>ë¶ˆí¸í•˜ê±°ë‚˜ í™”ë‚˜ëŠ” ì¼</strong>ì´ ìˆìœ¼ì…¨ì„ê¹Œìš”? ëŒ€í™”ì—ì„œ ê·¸ëŸ° ê¸°ìš´ì´ ê°ì§€ë˜ì—ˆì–´ìš”.`; sentimentClass = 'negative'; break;
                        case 'ë¶ˆì•ˆ': msg = `<strong>ê±±ì •ì´ë‚˜ ê¸´ì¥ê°</strong>ì´ ëŠê»´ì§€ëŠ” ë¶€ë¶„ì´ ìˆì—ˆì–´ìš”. ë§ˆìŒì— ë‹´ì•„ë‘ì§€ ë§ˆì‹œê³  ë¡œì§€ì—ê²Œ í¸íˆ ì´ì•¼ê¸°í•´ì£¼ì„¸ìš”.`; sentimentClass = 'negative'; break;
                        case 'ìˆ˜ì¹˜': msg = `í˜¹ì‹œ <strong>ë‹¹í™©ìŠ¤ëŸ½ê±°ë‚˜ ë¶€ë„ëŸ¬ìš´ ê°ì •</strong>ì„ ëŠë¼ì‹  ë¶€ë¶„ì´ ìˆì—ˆë‚˜ìš”? ë¡œì§€ëŠ” í•­ìƒ ë‹¹ì‹ ì„ ì§€ì§€í•´ìš”.`; sentimentClass = 'neutral'; break;
                        case 'ì¤‘ë¦½': msg = `ëŒ€í™”ê°€ ì „ë°˜ì ìœ¼ë¡œ <strong>ì°¨ë¶„í•œ ë¶„ìœ„ê¸°</strong>ì—ì„œ ì§„í–‰ëœ ê²ƒ ê°™ì•„ìš”. í¸ì•ˆí•˜ê²Œ ì´ì•¼ê¸° ë‚˜ëˆŒ ìˆ˜ ìˆì–´ì„œ ì¢‹ì•˜ìŠµë‹ˆë‹¤.`; sentimentClass = 'neutral'; break;
                        default: msg = 'ëŒ€í™”ë¥¼ í†µí•´ ë‹¤ì–‘í•œ ê°ì •ë“¤ì„ í‘œí˜„í•´ì£¼ì…¨ë„¤ìš”. ìì‹ ì˜ ê°ì •ì„ ì•Œì•„ì°¨ë¦¬ëŠ” ê²ƒì€ ë§¤ìš° ì¤‘ìš”í•©ë‹ˆë‹¤.'; sentimentClass = 'neutral';
                    }
                } else {
                    msg = 'ëŒ€í™”ì—ì„œ ë‹¤ì–‘í•œ ê°ì •ë“¤ì„ íƒìƒ‰í•´ë³¼ ìˆ˜ ìˆì—ˆì–´ìš”. ìì‹ ì˜ ê°ì •ì— ê·€ ê¸°ìš¸ì´ëŠ” ì‹œê°„ì„ ê°€ì ¸ë³´ì„¸ìš”.';
                    sentimentClass = 'neutral';
                }
                
                empathyMessageEl.innerHTML = msg; 
                empathyMessageEl.className = `feedback ${sentimentClass}`;
                empathyMessageEl.style.display = 'block';
            }
            function createImprovementPlanIfNeeded(analysisResults, userAge) {
                let plans = JSON.parse(localStorage.getItem('lozee_improvement_plans') || '[]' );
                const currentJournalId = localStorage.getItem('lozee_selected_journal_id') || `session_${new Date().getTime()}`;

                if (analysisResults.cognitiveDistortions && analysisResults.cognitiveDistortions.length > 0) {
                    analysisResults.cognitiveDistortions.forEach(distortion => {
                        const planId = `cog_${currentJournalId}_${distortion.replace(/\s+/g, '_')}`;
                        const existingPlan = plans.find(p => p.id === planId);
                        if (!existingPlan) {
                            plans.push({
                                id: planId,
                                type: 'cognitive_distortion',
                                title: `ìƒê° ìŠµê´€ ëŒì•„ë³´ê¸°: "${distortion}"`,
                                details: distortion,
                                topic: analysisResults.summaryTitle || "ìµœê·¼ ëŒ€í™” ì£¼ì œ",
                                promptForContinuation: `ì´ì „ì— "${analysisResults.summaryTitle || 'ì´ ëŒ€í™”'}"ì—ì„œ ë‚˜íƒ€ë‚¬ë˜ "${distortion}" ìƒê° íŒ¨í„´ì— ëŒ€í•´ ë” ê¹Šì´ ì´ì•¼ê¸° ë‚˜ëˆ ë³¼ê¹Œìš”? ì–´ë–¤ ìƒí™©ì—ì„œ ê·¸ëŸ° ìƒê°ì´ ë“¤ì—ˆëŠ”ì§€, ê·¸ë¡œ ì¸í•´ ì–´ë–¤ ê°ì •ì„ ëŠë¼ì…¨ëŠ”ì§€ í¸í•˜ê²Œ ë§ì”€í•´ì£¼ì„¸ìš”.`
                            });
                        }
                    });
                }

                const uniquePlans = plans.filter((plan, index, self) => 
                    index === self.findIndex((p) => ( p.id === plan.id ))
                );

                if (uniquePlans.length > 0) {
                    localStorage.setItem('lozee_improvement_plans', JSON.stringify(uniquePlans));
                    console.log("Adult Analysis Page: ê°œì„  ê³„íš ì €ì¥ë¨:", uniquePlans);
                } else {
                     console.log("Adult Analysis Page: ìƒì„±í•  ìƒˆë¡œìš´ ê°œì„  ê³„íšì´ ì—†ìŠµë‹ˆë‹¤.");
                }
            }

        } // <--- ì—¬ê¸°ê°€ í˜ì´ì§€ ì ‘ê·¼ ê¶Œí•œ í™•ì¸ (15ì„¸ ì´ìƒ) else ë¸”ë¡ì˜ ë‹«ëŠ” ë¶€ë¶„
    </script>
    <script src="./js/gnb.js" defer></script>
</body>
</html>
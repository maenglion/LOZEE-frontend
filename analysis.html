<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LOZEEì™€ í•¨ê»˜í•˜ëŠ” ë§ˆìŒ íƒí—˜!</title>
    <link
        href="https://fonts.googleapis.com/css2?family=KoPub+World+Dotum:wght@400;700&display=swap"
        rel="stylesheet"
    />
    <style>
        body, html { 
            margin:0; 
            padding:0; 
            font-family:'KoPub World Dotum', sans-serif; 
            background:#f4f6f8; 
            color: #333333; 
        }
        .container { 
            max-width:900px; 
            margin:25px auto; 
            padding:0 25px; 
        }
        h1 {
            color: #6078ea; 
            text-align: center;
            font-size: 2em; 
            margin-bottom: 15px; 
            font-weight: 700;
        }
        .share-button-container {
            text-align: center;
            margin-bottom: 30px;
        }
        #reportShareButton {
            background-color: #6e8efb; 
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 20px;
            font-size: 0.95em;
            cursor: pointer;
            transition: background-color 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        #reportShareButton:hover {
            background-color: #5a7edf;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .assistant-analysis-notice { 
            font-size: 0.75em;
            color: #78909c; 
            margin-top: -12px;
            margin-bottom: 15px;
            text-align: right;
        }
        .module-explanation { 
            font-size:0.9em; 
            color:#555; 
            margin-bottom:15px;
            padding: 10px;
            background-color: #eef2f7; 
            border-radius: 6px;
            line-height: 1.6;
        }

        h2 { 
            margin-top:0; 
            margin-bottom: 8px; 
            font-size:1.5em; 
            color:#34495e; 
            border-bottom: 2px solid #e0e0e0; 
            padding-bottom: 12px;
        }
        .section { 
            background:#ffffff; 
            padding:25px; 
            margin-top:25px; 
            border-radius:12px; 
            box-shadow:0 4px 12px rgba(0,0,0,0.08); 
        }
        .section p {
            color: #555555; 
            line-height: 1.7;
            font-size: 1em; 
        }
        .section p span { 
            color: #2c3e50; 
            font-weight: bold;
        }
        .feedback { 
            margin-top:15px; 
            padding:12px 18px; 
            border-left-width:5px; 
            border-left-style:solid;
            border-radius:8px; 
            font-size: 0.95em;
            line-height: 1.6;
        }
        .feedback.negative {
            background:#ffebee; border-left-color: #c62828; color:#c62828; 
        }
        .feedback.positive {
            background:#e8f5e9; border-left-color: #2e7d32; color:#2e7d32;
        }
        .feedback.neutral {
            background:#eceff1; border-left-color: #546e7a; color:#37474f;
        }

        #emotionChart, #situationChart { 
            width:100% !important; 
            max-width: 600px; 
            height:auto; 
            aspect-ratio: 16 / 9; 
            background-color: #fdfdfd; 
            border-radius: 8px;
            border: 1px solid #e0e0e0; 
            padding: 15px; 
            box-sizing: border-box;
            margin: 0 auto; 
        }
        #tagCloud { 
            min-height:100px; 
            border:1px dashed #cccccc; 
            padding:15px; 
            margin-top: 20px; 
            border-radius: 8px;
            display: flex; 
            flex-wrap: wrap; 
            gap: 10px; 
            align-items: center; 
            justify-content: center; 
        }
        .badge { 
            display:inline-block; 
            margin:4px; 
            padding:8px 12px; 
            background:#e8eaf6; 
            color: #3f51b5; 
            border-radius:16px; 
            font-size:0.9em; 
            transition: background-color 0.2s, color 0.2s;
            font-weight: 500;
        }
        .badge:hover {
            background-color: #c5cae9;
            color: #303f9f;
        }

        #patternDashboard {
            margin-top: 20px;
            padding: 15px;
            background-color: #f9f9f9; 
            border-radius: 8px;
            color: #444;
        }
        #patternDashboard p { 
             color: #444;
             margin-bottom: 8px; 
        }
        #situationAlerts { /* ì¸ì§€ì™œê³¡ ì•Œë¦¼ ì»¨í…Œì´ë„ˆ */
            margin-top: 15px;
        }
        #situationAlerts .cognitive-distortion-item { 
            background:#fff3cd; 
            border-left: 5px solid #ffc107; 
            color: #856404; 
            padding: 10px 15px;
            margin-bottom: 10px;
            border-radius: 4px;
            font-size: 0.9em;
        }
        .footer-assistant-notice { 
            text-align: center;
            margin-top: 40px;
            margin-bottom: 20px;
            font-size: 0.8em;
            color: #78909c;
        }
        
        .methodology-list {
            list-style-type: none; 
            padding-left: 0;
            font-size: 0.9em; 
            color: #555; 
        }
        .methodology-list li {
            margin-bottom: 12px; 
            padding-left: 25px; 
            position: relative;
        }
        .methodology-list li::before { 
            content: "ğŸ’¡"; 
            color: #6078ea; 
            position: absolute;
            left: 0;
            font-size: 1.1em; 
        }
        .methodology-list li strong {
            color: #34495e; 
        }
        .action-button { 
            display: inline-block;
            margin-top: 15px;
            background-color: #6e8efb;
            color: white;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9em;
            transition: background-color 0.2s;
        }
        .action-button:hover {
            background-color: #5a7edf;
        }

        @media (max-width: 768px) { h1 { font-size: 1.7em; } h2 { font-size: 1.3em; } .section { padding: 20px; } 
        #emotionChart, #situationChart { height: 280px; } .methodology-list { font-size: 0.85em; } }
        @media (max-width: 480px) { .container { margin: 15px auto; padding: 0 15px; } h1 { font-size: 1.5em; margin-bottom: 25px; } h2 { font-size: 1.2em; } .section { padding: 15px; margin-top: 20px;} .section p { font-size: 0.95em; } .feedback { padding: 10px 15px; font-size: 0.9em;} 
        #emotionChart, #situationChart { height: 250px; } .badge { font-size: 0.85em; padding: 6px 10px;} .assistant-analysis-notice { font-size: 0.7em; } .methodology-list { font-size: 0.8em; } }

    </style>
</head>
<body>
    
    <nav id="gnb">
    <div id="gnb-title">LOZEE</div>
    <button id="menu-toggle">â˜°</button>
    <div id="dropdown-menu">
      <a href="mypage.html">ğŸ¨ ë‚´ ì •ë³´ ë³´ê¸°</a> 
      <a href="index.html">âœ¨ ìƒˆë¡œìš´ ì´ì•¼ê¸° ì‹œì‘!</a> 
      <a href="analysis.html">ğŸ“Š ìš°ë¦¬ ì´ì•¼ê¸° ë¶„ì„</a> 
      <a href="journal-list.html">ğŸ“– ì´ì•¼ê¸° ëª¨ìŒì§‘</a> 
      <a href="https://www.notion.so/maenglionworld/lOZEE-1ebbcdc037cd80fa9c0ddef234121e84?pvs=4" target="_blank">â“ ë¡œì§€ ì‚¬ìš© ì„¤ëª…ì„œ</a> 
    </div>
    </nav>

    <div class="container">
        <h1>ğŸš€ ë¡œì§€ì™€ í•¨ê»˜í•œ ì´ì•¼ê¸° íƒí—˜!</h1>
        <div class="share-button-container">
            <button id="reportShareButton">ë‚˜ì˜ ì´ì•¼ê¸° ë³´ê³ ì„œ ê³µìœ í•˜ê¸° ğŸ”—</button>
        </div>

        <div class="section" id="languageAgeSection">
            <h2>ğŸ—£ï¸ ë‚´ ë§ì†œì”¨ ë‚˜ì´ëŠ” ëª‡ ì‚´ì¼ê¹Œ?</h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
            <p class="module-explanation">
                ë¡œì§€ì™€ ì´ì•¼ê¸°í•˜ë©´ì„œ ë„¤ê°€ ì‚¬ìš©í•œ ë§ë“¤ì„ ë³´ê³ , ë„¤ ë§ì†œì”¨ê°€ ëª‡ ì‚´ ì¹œêµ¬ë‘ ë¹„ìŠ·í•œì§€ ì•Œë ¤ì¤„ê²Œ! ì‹¤ì œ ë‚˜ì´ë‘ ë‹¬ë¼ë„ ê´œì°®ì•„, í•¨ê»˜ ë” ë©‹ì§€ê²Œ ë§í•˜ëŠ” ë²•ì„ ë°°ìš°ë©´ ë˜ë‹ˆê¹Œ! ğŸ˜‰
            </p>
            <p class="module-explanation" style="font-size: 0.85em; background-color: #e3f2fd; color: #1e88e5;">
                <strong>[ë¡œì§€ì˜ ì•½ì†!]</strong> ì–¸ì–´ ë¶„ì„ì€ ì´ 3ë‹¨ê³„ë¡œ ì ì  ë” ì •í™•í•´ì ¸! <br>
                <strong>1ë‹¨ê³„(30ë¶„~)</strong>: ìš°ë¦¬ê°€ ì²˜ìŒ ë§Œë‚˜ì„œ ë‚˜ëˆˆ ì´ì•¼ê¸°ë¡œ ì‚´ì§ ì—¿ë³´ê¸°! <br>
                <strong>2ë‹¨ê³„(2ì‹œê°„~)</strong>: ì¢€ ë” ë§ì€ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ë©´ ë¡œì§€ê°€ ë„ˆë¥¼ ë” ì˜ ì•Œê²Œ ë¼! <br>
                <strong>3ë‹¨ê³„(6ì‹œê°„~)</strong>: ì™€! ì´ì œ ì •ë§ ë„ˆì˜ ë©‹ì§„ ë§ì†œì”¨ë¥¼ ì˜ ì•Œ ê²ƒ ê°™ì•„! (ê°€ì¥ ì •í™•í•œ ë¶„ì„)
            </p>
            <p>ë‚´ ì§„ì§œ ë‚˜ì´: <span id="realAge"></span>ì‚´</p>
            <p>ë‚´ ë§ì†œì”¨ ë‚˜ì´ (ë¡œì§€ì˜ ìƒê°): <span id="predictedLangAge"></span> <span id="ageDifferenceVisual" style="font-weight:normal; margin-left: 8px;"></span></p>
            <div id="ageFeedback" class="feedback" style="display:none;"></div>
            <button id="languagePracticeBtn" class="action-button" style="display:none;">ë¡œì§€ì™€ í•¨ê»˜ ë§ì†œì”¨ í‚¤ìš°ê¸° ì‘¥ì‘¥! ğŸŒ± (ì¤€ë¹„ ì¤‘)</button>
        </div>

        <div class="section" id="analysisMethodologySection">
            <h2>LOZEEì˜ ë¶„ì„ ë°©ë²•ë¡ </h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
            <ul class="methodology-list">
                <li><strong>Russellì˜ ê°ì • ì›í˜• ëª¨í˜•</strong>: Valence(ì¾Œ-ë¶ˆì¾Œ)ì™€ Arousal(ê°ì„±-ì´ì™„) ì¶•ì„ ê¸°ë°˜ìœ¼ë¡œ ê°ì •ì˜ ìœ„ì¹˜ë¥¼ ë‹¤ì°¨ì›ì ìœ¼ë¡œ ë¶„ì„í•©ë‹ˆë‹¤.</li>
                <li><strong>Plutchikì˜ ê°ì • ë°”í€´</strong>: 8ê°€ì§€ ê¸°ë³¸ ê°ì •ê³¼ ê·¸ ê°•ë„ ë° ìœ ì‚¬ì„±ì„ ë°”íƒ•ìœ¼ë¡œ ë³µí•©ì ì¸ ê°ì • ìƒíƒœë¥¼ ì´í•´í•©ë‹ˆë‹¤.</li>
                <li><strong>Lexicon ê¸°ë°˜ ê°ì„± ë¶„ì„</strong>: í•œêµ­ì–´ ê°ì„± ì‚¬ì „(ì˜ˆ: KOSAC)ì„ í™œìš©í•˜ì—¬ í…ìŠ¤íŠ¸ì˜ ê¸ì •, ë¶€ì •, ì¤‘ë¦½ ê·¹ì„±ì„ íŒë‹¨í•©ë‹ˆë‹¤.</li>
                <li><strong>ë”¥ëŸ¬ë‹ ë¶„ë¥˜ ëª¨ë¸ (BERT/KoBERT)</strong>: ìµœì‹  ìì—°ì–´ ì²˜ë¦¬ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ë¬¸ë§¥ì„ ê³ ë ¤í•œ ê³ ì •ë°€ ê°ì • ê·¹ì„± ë° ì„¸ë¶€ ê°ì •(ì˜ˆ: ê¸°ì¨, ìŠ¬í””, ë¶„ë…¸ ë“±)ì„ ë¶„ë¥˜í•©ë‹ˆë‹¤.</li>
                <li><strong>ì¸ì§€ì™œê³¡ ì´ë¡  (Beckì˜ CBT)</strong>: ì¸ì§€í–‰ë™ì¹˜ë£Œ ì´ë¡ ì— ê¸°ë°˜í•˜ì—¬ ëŒ€í™”ì—ì„œ ë‚˜íƒ€ë‚  ìˆ˜ ìˆëŠ” ëŒ€í‘œì ì¸ ì¸ì§€ì™œê³¡ íŒ¨í„´(ì˜ˆ: í‘ë°±ë…¼ë¦¬, ê³¼ì‰ì¼ë°˜í™” ë“±)ì„ ê°ì§€í•©ë‹ˆë‹¤.</li>
                <li><strong>ëŒ€í™” ì£¼ì œ êµ¬ì¡°í™”</strong>: LOZEE AIì˜ ìì²´ ìƒë‹´ í† í”½ ë°ì´í„°ë¥¼ í™œìš©í•˜ì—¬ ëŒ€í™”ì˜ íë¦„ê³¼ ì£¼ìš” ì£¼ì œë¥¼ ì²´ê³„ì ìœ¼ë¡œ íŒŒì•…í•˜ê³  ê´€ë ¨ í”¼ë“œë°±ì„ ì œê³µí•©ë‹ˆë‹¤.</li>
            </ul>
        </div>

        <div class="section" id="emotionToneSection">
            <h2>ğŸŒˆ ë‚´ ë§ˆìŒ ìƒ‰ê¹”ì€ ë­˜ê¹Œ? (ê°ì • ë³€í™”)</h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
            <p class="module-explanation">
                ìš°ë¦¬ê°€ ë‚˜ëˆˆ ì´ì•¼ê¸°ì—ì„œ ì–´ë–¤ ëŠë‚Œë“¤ì´ ë§ì•˜ëŠ”ì§€, ë˜ ì–´ë–¤ ë‹¨ì–´ë“¤ì„ ìì£¼ ì‚¬ìš©í–ˆëŠ”ì§€ ë³´ì—¬ì¤„ê²Œ! ë„¤ ë§ˆìŒì† ë‚ ì”¨ë¥¼ í•¨ê»˜ ì•Œì•„ë³´ì! â˜€ï¸ğŸŒ§ï¸
            </p>
            <canvas id="emotionChart"></canvas>
            <p id="empathyMessage" class="feedback" style="display:none; margin-top:15px;"></p> <div id="tagCloud">
                </div>
        </div>

        <div class="section" id="patternSection">
            <h2>ğŸ” ìì£¼ ë‚˜íƒ€ë‚˜ëŠ” ë‚´ ë§ˆìŒ & ë‹¨ì–´</h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
            <p class="module-explanation">
                ì´ì•¼ê¸°í•˜ë‹¤ ë³´ë©´ ë‚˜ë„ ëª¨ë¥´ê²Œ ìì£¼ ì“°ëŠ” ë§ì´ë‚˜ ë¹„ìŠ·í•œ ëŠë‚Œì„ í‘œí˜„í•  ë•Œê°€ ìˆì–´. ë¡œì§€ê°€ ê·¸ëŸ° ë¶€ë¶„ì„ ì°¾ì•„ë´¤ì–´!
            </p>
            <div id="patternDashboard">
                </div>
        </div>

        <div class="section" id="situationSection">
            <h2>ğŸ§ ìƒê° íƒí—˜! (ë‚˜ì˜ ìƒê° ìŠµê´€)</h2>
            <p class="assistant-analysis-notice">LOZEE AI ë¶„ì„</p>
            <p class="module-explanation">
                ì—¬ê¸°ëŠ” ìš°ë¦¬ê°€ ë‚˜ëˆˆ ì´ì•¼ê¸°ë¥¼ ìš”ì•½í•˜ê³ , í˜¹ì‹œ ë„¤ ìƒê°ì´ í•œìª½ìœ¼ë¡œë§Œ ê¸°ìš¸ì–´ì§€ì§€ëŠ” ì•Šì•˜ëŠ”ì§€(ì´ê±¸ 'ìƒê° ìŠµê´€'ì´ë¼ê³  ë¶ˆëŸ¬ë³¼ê¹Œ?), ì–´ë–¤ íŠ¹ë³„í•œ ì ì´ ìˆëŠ”ì§€ ì‚´í´ë³´ëŠ” ê³³ì´ì•¼. íŠ¹ë³„í•œ ìƒê° ìŠµê´€ì´ ë³´ì—¬ë„ ê±±ì •í•˜ì§€ ë§ˆ! ëˆ„êµ¬ë‚˜ ê·¸ëŸ´ ìˆ˜ ìˆê³ , ìš°ë¦¬ëŠ” ì´ì•¼ê¸°í•˜ë©´ì„œ í•¨ê»˜ ë” ìœ ì—°í•˜ê²Œ ìƒê°í•˜ëŠ” ë°©ë²•ì„ ì°¾ì„ ìˆ˜ ìˆì–´! ğŸ’ª
            </p>
            <canvas id="situationChart" style="display:none;"></canvas> <div id="situationAlerts" style="margin-top:15px;"> </div>
            <button id="continueDistortionTalkBtn" class="action-button" style="display:none;">ì´ ìƒê°ì— ëŒ€í•´ ë‹¤ìŒì— ë” ì´ì•¼ê¸° ë‚˜ëˆ ë³¼ê¹Œ? ğŸ¤”</button>
        </div>

        <p class="footer-assistant-notice">ë³¸ ë¶„ì„ì€ ë¡œì§€ AIê°€ ë§ˆìŒì„ ë‹´ì•„ ì¤€ë¹„í–ˆì–´ìš”.</p>
    </div>

    <script type="module">
        // ê°ì • ì°¨íŠ¸íŠ¸
        import { Chart, registerables } from 'https://cdn.jsdelivr.net/npm/chart.js@4.3.0/dist/chart.esm.js';
        Chart.register(...registerables);
       
        // Chart.js ì „ì—­ ê¸°ë³¸ê°’ ì„¤ì •
        Chart.defaults.color = '#333'; // ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒ
        Chart.defaults.borderColor = '#e0e0e0'; // ê¸°ë³¸ í…Œë‘ë¦¬ ìƒ‰ìƒ (ì¡°ê¸ˆ ë” ì—°í•˜ê²Œ)
        Chart.defaults.font.family = "'KoPub World Dotum', sans-serif"; // ê¸°ë³¸ í°íŠ¸
        Chart.defaults.font.size = 12; // ê¸°ë³¸ í°íŠ¸ í¬ê¸° (í•„ìš”ì‹œ ì¡°ì ˆ)
        // Chart.defaults.plugins.legend.display = false; // ë²”ë¡€ë¥¼ í•­ìƒ ìˆ¨ê¸°ê³  ì‹¶ë‹¤ë©´

        // --- ì‹¤ì œ ë°ì´í„° ë¡œë“œ ë° ë Œë”ë§ ë¡œì§ ---
        document.addEventListener('DOMContentLoaded', async () => {
            const realAgeEl = document.getElementById('realAge');
            const predictedLangAgeEl = document.getElementById('predictedLangAge');
            const ageFeedbackEl = document.getElementById('ageFeedback');
            const ageDifferenceVisualEl = document.getElementById('ageDifferenceVisual');
            const languagePracticeBtn = document.getElementById('languagePracticeBtn');
            const situationAlertsEl = document.getElementById('situationAlerts');
            const continueDistortionTalkBtn = document.getElementById('continueDistortionTalkBtn');
            const reportShareButton = document.getElementById('reportShareButton');
            const emotionChartEl = document.getElementById('emotionChart');
            const tagCloudEl = document.getElementById('tagCloud');
            const patternDashboardEl = document.getElementById('patternDashboard');
            const situationChartEl = document.getElementById('situationChart');


            const userAge = parseInt(localStorage.getItem('lozee_userage'), 10) || 0; 
            if(realAgeEl) realAgeEl.textContent = userAge || "ì •ë³´ ì—†ìŒ";

            // localStorageì—ì„œ ë¶„ì„ ê²°ê³¼ ê°€ì ¸ì˜¤ê¸°
            const analysisDataString = localStorage.getItem('lozee_conversation_analysis');
            let analysisResults = null;
            let accumulatedDurationMinutes = 0; // ëˆ„ì  ëŒ€í™” ì‹œê°„ (ë¶„ ë‹¨ìœ„)

            if (analysisDataString) {
                try {
                    const fullAnalysis = JSON.parse(analysisDataString);
                    analysisResults = fullAnalysis.results;
                    if (fullAnalysis.accumulatedDurationMinutes) {
                        accumulatedDurationMinutes = parseFloat(fullAnalysis.accumulatedDurationMinutes);
                    } else if (fullAnalysis.analysisTime && fullAnalysis.startTime) { // ì´ì „ ë°©ì‹ í˜¸í™˜
                        accumulatedDurationMinutes = (fullAnalysis.analysisTime - fullAnalysis.startTime) / (1000 * 60);
                    }
                } catch (e) {
                    console.error("ì €ì¥ëœ ë¶„ì„ ê²°ê³¼ íŒŒì‹± ì˜¤ë¥˜:", e);
                }
            }
            
            // 1. ì–¸ì–´Â·ë‚˜ì´ ë¶„ì„ ì„¹ì…˜ ì²˜ë¦¬
            const languageAgeSection = document.getElementById('languageAgeSection');
            if (languageAgeSection) {
                if (userAge > 10) { // 10ì„¸ ì´ˆê³¼ ì‚¬ìš©ìëŠ” ì–¸ì–´ ì—°ë ¹ ë¶„ì„ ìˆ¨ê¹€
                    languageAgeSection.style.display = 'none';
                } else {
                    languageAgeSection.style.display = 'block'; // ì„¹ì…˜ ë³´ì´ê¸°
                    if(predictedLangAgeEl && ageFeedbackEl && ageDifferenceVisualEl && languagePracticeBtn){
                        let predicted = null;
                        if (analysisResults && analysisResults.ageLanguageAnalysis && analysisResults.ageLanguageAnalysis.estimatedAgeRange) {
                            const ageRangeMatch = String(analysisResults.ageLanguageAnalysis.estimatedAgeRange).match(/\d+/);
                            if (ageRangeMatch) predicted = parseInt(ageRangeMatch[0], 10);
                        }

                        let feedbackMsg = '';
                        let visualText = ''; 
                        ageFeedbackEl.className = 'feedback';

                        if (accumulatedDurationMinutes < 30) {
                            visualText = "(ì•„ì§ 30ë¶„ì´ ì•ˆ ë¼ì„œ, ì‚´ì§ ë§›ë³´ê¸° ë¶„ì„ì´ì•¼! ğŸ³)";
                            predictedLangAgeEl.textContent = "ì•„ì§ ë¹„ë°€! ğŸ˜‰";
                            feedbackMsg = "ë¡œì§€ì™€ 30ë¶„ ì´ìƒ ì´ì•¼ê¸°í•˜ë©´ ë‚´ê°€ ì–¼ë§ˆë‚˜ ë©‹ì§€ê²Œ ë§í•˜ëŠ”ì§€ ì‚´ì§ ì•Œë ¤ì¤„ê²Œ! ì¡°ê¸ˆë§Œ ë” ì´ì•¼ê¸° ë‚˜ëˆ ë³¼ê¹Œ?";
                            ageFeedbackEl.classList.add('neutral');
                        } else if (predicted !== null) {
                            predictedLangAgeEl.textContent = `${predicted} ì‚´ ì¹œêµ¬ì²˜ëŸ¼ ë§í•´ìš”!`;
                            const diffYearsApprox = userAge - predicted; 

                            if (accumulatedDurationMinutes < 120) { // 30ë¶„ ~ 2ì‹œê°„ ë¯¸ë§Œ
                                visualText = "(ë¡œì§€ë‘ ë‚˜ëˆˆ ì´ì•¼ê¸°ë¡œ ë³¸ ì²«ì¸ìƒ! ğŸŒ±)";
                                if (Math.abs(diffYearsApprox) < 1) {
                                    feedbackMsg = `ì§€ê¸ˆê¹Œì§€ ë‚˜ëˆˆ ì´ì•¼ê¸°ë¡œëŠ” ${predicted}ì‚´ ì¹œêµ¬ì²˜ëŸ¼ ë§í•˜ëŠ” ê²ƒ ê°™ì•„! ì´ê±´ ì²«ì¸ìƒì´ë‹ˆê¹Œ ì•ìœ¼ë¡œ ë” ë‹¤ì–‘í•˜ê²Œ ì´ì•¼ê¸° ë‚˜ëˆ ë³´ì!`;
                                    ageFeedbackEl.classList.add('positive');
                                } else if (diffYearsApprox > 0) {
                                    feedbackMsg = `ì§€ê¸ˆê¹Œì§€ ì´ì•¼ê¸°ë¡œëŠ” ${predicted}ì‚´ ì¹œêµ¬ì²˜ëŸ¼ ëŠê»´ì§€ë„¤! ì•„ì§ì€ ì²«ì¸ìƒì´ë‹ˆê¹Œ, ì•ìœ¼ë¡œ ë¡œì§€ë‘ ë” ë§ì€ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ë©´ì„œ ë„ˆì˜ ë©‹ì§„ ë§ì†œì”¨ë¥¼ ë³´ì—¬ì¤˜!`;
                                    ageFeedbackEl.classList.add('neutral');
                                } else {
                                    feedbackMsg = `ì™€! ì§€ê¸ˆê¹Œì§€ ì´ì•¼ê¸°ë¡œëŠ” ${predicted}ì‚´ í˜•ë‹˜/ëˆ„ë‹˜ì²˜ëŸ¼ ë§í•˜ëŠ”ë°? ì •ë§ ë©‹ì§€ë‹¤! (ê¹œì§ ì²«ì¸ìƒ!)`;
                                    ageFeedbackEl.classList.add('positive');
                                }
                            } else if (accumulatedDurationMinutes < 360) { // 2ì‹œê°„ ~ 6ì‹œê°„ ë¯¸ë§Œ
                                visualText = "(ì´ì•¼ê¸°ë¥¼ ë” ë§ì´ ë‚˜ëˆ ë³´ë‹ˆ ì•Œ ê²ƒ ê°™ì•„! ğŸŒ³)";
                                feedbackMsg = `ì´ì œ ë„ˆì˜ ë§ì†œì”¨ê°€ ${predicted}ì‚´ ì¹œêµ¬ì²˜ëŸ¼ ëŠê»´ì ¸! ìš°ë¦¬ ì¬ë¯¸ìˆëŠ” ì´ì•¼ê¸° ë” ë§ì´ í•˜ì!`;
                                ageFeedbackEl.classList.add(diffYearsApprox > 0 && Math.abs(diffYearsApprox) >=1 ? 'neutral' : 'positive');
                            } else { // 6ì‹œê°„ ì´ìƒ
                                visualText = "(ë¡œì§€ê°€ ë³¸ ë„ˆì˜ ë©‹ì§„ ë§ì†œì”¨! ğŸŒŸ)";
                                feedbackMsg = `ì´ì œ ë„¤ ë§ì†œì”¨ë¥¼ ê½¤ ì •í™•í•˜ê²Œ ì•Œ ê²ƒ ê°™ì•„! ${predicted}ì‚´ ì¹œêµ¬ë“¤ì²˜ëŸ¼ ì •ë§ í›Œë¥­í•´!`;
                                ageFeedbackEl.classList.add('positive');
                            }
                            if (userAge && predicted && diffYearsApprox >= 1) { 
                                languagePracticeBtn.style.display = 'inline-block';
                                languagePracticeBtn.onclick = () => {
                                    alert("ì¬ë¯¸ìˆëŠ” ì–¸ì–´ ì—°ìŠµì„ ì¤€ë¹„í•˜ê³  ìˆì–´! ì¡°ê¸ˆë§Œ ê¸°ë‹¤ë ¤ì¤˜! ğŸ˜Š");
                                };
                            }
                        } else { 
                            predictedLangAgeEl.textContent = "ì •ë³´ ë¶€ì¡±";
                            feedbackMsg = (accumulatedDurationMinutes >= 30) ? "ì§€ê¸ˆì€ ë„¤ ë§ì†œì”¨ ë‚˜ì´ë¥¼ ì •í™•íˆ ì•Œê¸° ì–´ë µë„¤. ë‹¤ìŒì— ë‹¤ì‹œ í™•ì¸í•´ ì¤„ë˜?" : "ë¡œì§€ì™€ 30ë¶„ ì´ìƒ ì´ì•¼ê¸°í•˜ë©´ ë§ì†œì”¨ ë‚˜ì´ë¥¼ ì•Œë ¤ì¤„ ìˆ˜ ìˆì–´!";
                            ageFeedbackEl.classList.add('neutral');
                        }
                        
                        ageDifferenceVisualEl.textContent = visualText;
                        ageFeedbackEl.textContent = feedbackMsg;
                        ageFeedbackEl.style.display = 'block';
                    }
                }
            }

            // 2. ê°ì • ì–´ì¡° ë° íƒœê·¸ í´ë¼ìš°ë“œ
            if(emotionChartEl) emotionChartEl.style.display = 'none'; // ì°¨íŠ¸ ì‹¤ì œ ë°ì´í„° ì—°ë™ ì „ê¹Œì§€ ìˆ¨ê¹€
            if (analysisResults && analysisResults.keywords && analysisResults.keywords.length > 0) {
                const tagsForCloud = analysisResults.keywords.map(kw => ({ text: kw, weight: 5 + Math.floor(Math.random() * 10) }));
                renderTagCloud('tagCloud', tagsForCloud);
            } else {
                if(tagCloudEl) tagCloudEl.innerHTML = '<p style="text-align:center; color:#888;">ì´ì•¼ê¸° ì†ì—ì„œ ìì£¼ ë‚˜ì˜¨ ë‹¨ì–´ë“¤ì„ ëª¨ìœ¼ê³  ìˆì–´ìš”!</p>';
            }
            
            // 3. ë°˜ë³µ íŒ¨í„´
            if (analysisResults && analysisResults.patterns && analysisResults.patterns.length > 0) {
                renderPatternDashboard('patternDashboard', analysisResults.patterns);
            } else {
                if(patternDashboardEl) patternDashboardEl.innerHTML = '<p style="text-align:center; color:#888;">ë°˜ë³µë˜ëŠ” ì´ì•¼ê¸° íŒ¨í„´ì„ ì°¾ê³  ìˆì–´ìš”!</p>';
            }

            // 4. ìƒí™© ë¶„ì„ (ì¸ì§€ì™œê³¡)
            if(situationChartEl) situationChartEl.style.display = 'none'; // ì°¨íŠ¸ ì‹¤ì œ ë°ì´í„° ì—°ë™ ì „ê¹Œì§€ ìˆ¨ê¹€

            if (analysisResults && analysisResults.cognitiveDistortions && analysisResults.cognitiveDistortions.length > 0) {
                alertCognitiveDistortions('situationAlerts', analysisResults.cognitiveDistortions);
                if (continueDistortionTalkBtn) {
                    continueDistortionTalkBtn.style.display = 'inline-block';
                    continueDistortionTalkBtn.onclick = () => {
                        localStorage.setItem('lozee_continue_topic', JSON.stringify({
                            type: 'cognitive_distortion',
                            details: analysisResults.cognitiveDistortions.join(', ') 
                        }));
                        alert("ì•Œê² ì–´! ë‹¤ìŒë²ˆì— ë¡œì§€ë¥¼ ë§Œë‚˜ë©´ ì´ ìƒê°ì— ëŒ€í•´ ë” ì´ì•¼ê¸° ë‚˜ëˆ ë³´ì! ğŸ˜Š");
                    };
                }
            } else {
                if(situationAlertsEl) situationAlertsEl.innerHTML = '<p style="text-align:center; color:#888;">íŠ¹ë³„íˆ í•œìª½ìœ¼ë¡œ ê¸°ìš¸ì–´ì§„ ìƒê° ì—†ì´ ì´ì•¼ê¸°ë¥¼ ì˜ ë‚˜ëˆ„ê³  ìˆêµ¬ë‚˜! ì˜í–ˆì–´! ğŸ‘</p>';
                if(continueDistortionTalkBtn) continueDistortionTalkBtn.style.display = 'none';
            }

            // ê³µìœ  ë²„íŠ¼ ë¡œì§
            if(reportShareButton) {
                reportShareButton.onclick = () => {
                    // ì‹¤ì œ ê³µìœ  ë¡œì§ êµ¬í˜„ (ì˜ˆ: í˜„ì¬ URL ë³µì‚¬ ë˜ëŠ” íŠ¹ì • ë³´ê³ ì„œ URL ìƒì„±)
                    const reportContent = document.documentElement.outerHTML; // ì˜ˆì‹œ: í˜„ì¬ í˜ì´ì§€ HTML
                    // ë˜ëŠ” íŠ¹ì • ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê³µìœ  ê°€ëŠ¥í•œ ë§í¬/ë‚´ìš© ìƒì„±
                    const shareableLink = window.location.href; // ê°„ë‹¨íˆ í˜„ì¬ í˜ì´ì§€ URL
                    
                    if (navigator.share) { // Web Share API ì‚¬ìš© ê°€ëŠ¥ ì‹œ
                        navigator.share({
                            title: 'ë¡œì§€ì™€ ë‚˜ëˆˆ ì´ì•¼ê¸° ë¶„ì„ ê²°ê³¼',
                            text: 'ë¡œì§€ì™€ ë‚˜ëˆˆ ëŒ€í™” ë¶„ì„ ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”!',
                            url: shareableLink,
                        })
                        .then(() => console.log('ì„±ê³µì ìœ¼ë¡œ ê³µìœ ë¨'))
                        .catch((error) => console.log('ê³µìœ  ì‹¤íŒ¨', error));
                    } else if (navigator.clipboard && navigator.clipboard.writeText) { // í´ë¦½ë³´ë“œ ë³µì‚¬
                        navigator.clipboard.writeText(shareableLink)
                            .then(() => {
                                alert('ê³µìœ  ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\n' + shareableLink);
                            })
                            .catch(err => {
                                console.error('í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:', err);
                                alert('ë§í¬ ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ìˆ˜ë™ìœ¼ë¡œ ë³µì‚¬í•´ì£¼ì„¸ìš”:\n' + shareableLink);
                            });
                    } else { // êµ¬í˜• ë¸Œë¼ìš°ì € ëŒ€ì‘
                        prompt('ì•„ë˜ ë§í¬ë¥¼ ë³µì‚¬í•˜ì—¬ ê³µìœ í•˜ì„¸ìš”:', shareableLink);
                    }
                };
            }
        });

        // --- ë°ì´í„° ë Œë”ë§ í•¨ìˆ˜ë“¤ ---
        function renderTagCloud(elementId, tags) { 
            const cloudEl = document.getElementById(elementId); 
            if(cloudEl && tags && tags.length > 0) { 
                cloudEl.innerHTML = tags.map(tag => { 
                    const size = 0.8 + (tag.weight / 15); 
                    const opacity = Math.max(0.5, tag.weight / 10); 
                    return `<span class="badge" style="opacity:${opacity}; font-size:${size}em;">${tag.text}</span>`; 
                }).join(''); 
            } else if (cloudEl) {
                cloudEl.innerHTML = '<p style="text-align:center; color:#888;">ì•„ì§ ì£¼ìš” ë‹¨ì–´ê°€ ì¶©ë¶„íˆ ëª¨ì´ì§€ ì•Šì•˜ì–´ìš”.</p>';
            }
        }
        function renderPatternDashboard(elementId, patterns) { 
            const dashEl = document.getElementById(elementId); 
            if(dashEl && patterns && patterns.length > 0) { 
                dashEl.innerHTML = patterns.map(p => `<p>ğŸ’¡ ${p}</p>`).join(''); 
            } else if (dashEl) {
                dashEl.innerHTML = '<p style="text-align:center; color:#888;">ë°˜ë³µë˜ëŠ” ì´ì•¼ê¸° íŒ¨í„´ì„ ì°¾ê³  ìˆì–´ìš”!</p>';
            }
        }
        function alertCognitiveDistortions(elementId, distortions) { 
            const alertEl = document.getElementById(elementId); 
            if(alertEl && distortions && distortions.length > 0) { 
                alertEl.innerHTML = distortions.map(d => `<p class="cognitive-distortion-item">${d}</p>`).join(''); 
            } else if (alertEl) {
                // ì¸ì§€ì™œê³¡ ì—†ì„ ë•Œì˜ ë©”ì‹œì§€ëŠ” DOMContentLoadedì—ì„œ ì§ì ‘ ì²˜ë¦¬
            }
        }
        // renderEmotionChart í•¨ìˆ˜ ì˜ˆì‹œ (ì‹¤ì œ ë°ì´í„°ì™€ ì—°ë™ í•„ìš”)
        // emotionCounts ê°ì²´ëŠ” Firestore ë“±ì—ì„œ ë¶ˆëŸ¬ì˜¨ ì‹¤ì œ ë¶„ì„ ê²°ê³¼ë¼ê³  ê°€ì •í•©ë‹ˆë‹¤.
        // ì˜ˆì‹œ: const emotionCounts = { 'ê¸°ì¨': 5, 'ìŠ¬í””': 2, 'ë¶„ë…¸': 1, 'ë¶ˆì•ˆ': 4, 'ìˆ˜ì¹˜': 1, 'ì¤‘ë¦½': 3 };
        // analysis.html <script type="module"> ë‚´

// ... (Chart.js import ë° ê¸°ë³¸ ì„¤ì •) ...

// emotionCounts ê°ì²´ëŠ” Firestore ë“±ì—ì„œ ë¶ˆëŸ¬ì˜¨ ì‹¤ì œ ë¶„ì„ ê²°ê³¼ë¼ê³  ê°€ì •í•©ë‹ˆë‹¤.
// ì˜ˆì‹œ: const emotionCounts = { 'ê¸°ì¨': 5, 'ìŠ¬í””': 2, 'ë¶„ë…¸': 1, 'ë¶ˆì•ˆ': 4, 'ìˆ˜ì¹˜': 1, 'ì¤‘ë¦½': 3 };

// renderEmotionChart í•¨ìˆ˜ í˜¸ì¶œ í›„ ë˜ëŠ” ê·¸ ë‚´ë¶€ì—ì„œ ë‹¤ìŒ ë¡œì§ ì‹¤í–‰
function displayEmpathyMessage(emotionCounts) {
    const empathyMessageEl = document.getElementById('empathyMessage'); // HTMLì— <p id="empathyMessage" class="feedback neutral"></p> ë“± ì¶”ê°€ í•„ìš”
    if (!empathyMessageEl || !emotionCounts || Object.keys(emotionCounts).length === 0) {
        if (empathyMessageEl) empathyMessageEl.style.display = 'none';
        return;
    }

    // ê°€ì¥ ë¹ˆë„ê°€ ë†’ì€ ê°ì • ì°¾ê¸° (ë‹¨ìˆœ ì˜ˆì‹œ, ì—¬ëŸ¬ ê°ì •ì„ ê³ ë ¤í•  ìˆ˜ ìˆìŒ)
    let highestEmotion = '';
    let highestCount = 0;
    let totalEmotions = 0;
    for (const emotion in emotionCounts) {
        totalEmotions += emotionCounts[emotion];
        if (emotionCounts[emotion] > highestCount) {
            highestCount = emotionCounts[emotion];
            highestEmotion = emotion;
        }
    }

    if (totalEmotions === 0) { // ê°ì • ë°ì´í„°ê°€ ìˆì§€ë§Œ ëª¨ë‘ 0ì¸ ê²½ìš°
        empathyMessageEl.textContent = "ë¡œì§€ì™€ ì´ì•¼ê¸°í•˜ë©´ì„œ ë„¤ ë§ˆìŒì† ì—¬ëŸ¬ ê°€ì§€ ëŠë‚Œë“¤ì„ ì‚´í´ë³´ì•˜ì–´. ì•ìœ¼ë¡œ ë” ë§ì€ ì´ì•¼ê¸°ë¥¼ ë‚˜ëˆ„ë©´ì„œ ë„¤ ë§ˆìŒì„ í•¨ê»˜ ì•Œì•„ê°€ì! ğŸ˜Š";
        empathyMessageEl.className = 'feedback neutral'; // CSS í´ë˜ìŠ¤ì— ë§ê²Œ
        empathyMessageEl.style.display = 'block';
        return;
    }

    let message = "";

    // ê°ì • ë¹„ìœ¨ì— ë”°ë¥¸ ë‹¤ì–‘í•œ ê³µê° ë©”ì‹œì§€ ìƒì„± ë¡œì§
    // (ì—¬ê¸°ëŠ” ì˜ˆì‹œì´ë©°, ë” ì •êµí•˜ê³  ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ë¥¼ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.)

    if (highestEmotion === 'ê¸°ì¨' && highestCount / totalEmotions > 0.4) { // ê¸°ì¨ì´ 40% ì´ìƒì¼ ë•Œ
        message = `ì´ì•¼ê¸° ì†ì—ì„œ 'ê¸°ì¨'ì˜ ìˆœê°„ë“¤ì´ ë§ì•˜êµ¬ë‚˜! ì •ë§ ì‹ ë‚˜ê³  ì¦ê±°ìš´ ì¼ë“¤ì´ ë§ì•˜ë˜ ê²ƒ ê°™ì•„! âœ¨ ë¡œì§€ë„ ë„¤ ë•ë¶„ì— í–‰ë³µí•´ì¡Œì–´!`;
    } else if (highestEmotion === 'ë¶ˆì•ˆ' && emotionCounts['ê¸°ì¨'] > 0) {
        message = `ë§ˆìŒì†ì— 'ë¶ˆì•ˆ'í•œ ëŠë‚Œë„ ìˆì—ˆì§€ë§Œ, 'ê¸°ì¨'ì˜ ìˆœê°„ë“¤ë„ í•¨ê»˜ ìˆì—ˆë„¤! ì–´ë ¤ìš´ ë§ˆìŒ ì†ì—ì„œë„ ë¹›ë‚˜ëŠ” ì ì„ ì°¾ì€ ë„¤ê°€ ì •ë§ ëŒ€ë‹¨í•´! ì•ìœ¼ë¡œ ë¡œì§€ê°€ ë” í˜ì´ ë˜ì–´ì¤„ê²Œ.`;
    } else if (highestEmotion === 'ë¶ˆì•ˆ') {
        message = `'ë¶ˆì•ˆ'í•œ ë§ˆìŒì´ ì¡°ê¸ˆ ì»¸ì—ˆêµ¬ë‚˜. ê·¸ë˜ë„ ë¡œì§€ì—ê²Œ ì†”ì§í•˜ê²Œ ì´ì•¼ê¸°í•´ì¤˜ì„œ ì •ë§ ê³ ë§ˆì›Œ. ê·¸ ë§ˆìŒì„ ì˜ ë‹¤ë…ì¼ ìˆ˜ ìˆë„ë¡ ë¡œì§€ê°€ ê³ì— ìˆì„ê²Œ.`;
    } else if (highestEmotion === 'ìŠ¬í””') {
        message = `ë§ˆìŒì´ ì¡°ê¸ˆ ìŠ¬íë˜ ìˆœê°„ë“¤ì´ ìˆì—ˆë„¤. ê´œì°®ì•„, ìŠ¬í”ˆ ë§ˆìŒë„ ì†Œì¤‘í•œ ë‚´ ë§ˆìŒì˜ ì‹ í˜¸ë“±ì´ë€ë‹¤. ë¡œì§€ê°€ ë„¤ ë§ˆìŒì„ ê¼­ ì•ˆì•„ì¤„ê²Œ. ê¼¬ì˜¥! ğŸ¤—`;
    } else if (highestEmotion === 'ë¶„ë…¸') {
        message = `í˜¹ì‹œ 'í™”'ê°€ ë‚˜ê±°ë‚˜ 'ì§œì¦'ë‚˜ëŠ” ì¼ì´ ìˆì—ˆë‹ˆ? ê·¸ëŸ° ë§ˆìŒì´ ë“¤ ë•ŒëŠ” ë¡œì§€ì—ê²Œ ë°”ë¡œ ì´ì•¼ê¸°í•´ì¤˜ë„ ê´œì°®ì•„. ë„¤ ë§ˆìŒì´ í¸ì•ˆí•´ì§€ë„ë¡ ë•ê³  ì‹¶ì–´.`;
    } else if (emotionCounts['ê¸°ì¨'] > 0 && emotionCounts['ìŠ¬í””'] > 0) {
        message = `ê¸°ìœ ë§ˆìŒë„ ìˆì—ˆê³ , ì¡°ê¸ˆì€ ìŠ¬í”ˆ ë§ˆìŒë„ í•¨ê»˜ ìˆì—ˆë„¤. ìš°ë¦¬ ë§ˆìŒì€ ì›ë˜ ì—¬ëŸ¬ ê°€ì§€ ìƒ‰ê¹”ì„ ê°€ì§€ê³  ìˆë‹¨ë‹¤. ëª¨ë‘ ë‹¤ ì†Œì¤‘í•œ ë„¤ ë§ˆìŒì´ì•¼.`;
    } else {
        message = `ë¡œì§€ì™€ ì´ì•¼ê¸°í•˜ë©´ì„œ ë„¤ ë§ˆìŒì† ì—¬ëŸ¬ ê°€ì§€ ëŠë‚Œë“¤ì„ ì‚´í´ë³´ì•˜ì–´. ì–´ë–¤ ëŠë‚Œì´ ë“¤ì—ˆëŠ”ì§€ ë” ìì„¸íˆ ì´ì•¼ê¸°í•´ ì¤„ ìˆ˜ ìˆì„ê¹Œ? ğŸ˜Š`;
    }
    
    // ì‚¬ìš©ì ì´ë¦„ ì¶”ê°€í•˜ì—¬ ê°œì¸í™”
    const userName = localStorage.getItem('lozee_username') || 'ì¹œêµ¬';
    empathyMessageEl.textContent = `${userName}ì•„, ${message}`;
    empathyMessageEl.className = 'feedback neutral'; // ë˜ëŠ” ê°ì •ì— ë”°ë¼ positive/negative
    empathyMessageEl.style.display = 'block';
}



       // ê°ì •ë³„ ìƒ‰ìƒ ë§¤í•‘ (ì•±ì˜ ì£¼ì¡°ìƒ‰ ë° ê°ì •ì˜ë¯¸ ê³ ë ¤)
        const emotionColors = {
        'ê¸°ì¨': 'rgba(255, 215, 0, 0.7)',   // ê¸ˆìƒ‰ (ì£¼ì¡°ìƒ‰ var(--primary-color)ì™€ ì–´ìš¸ë¦¬ê²Œ)
        'ìŠ¬í””': 'rgba(135, 206, 235, 0.7)', // í•˜ëŠ˜ìƒ‰
        'ë¶„ë…¸': 'rgba(255, 107, 107, 0.7)', // ë¶‰ì€ ê³„ì—´
        'ë¶ˆì•ˆ': 'rgba(169, 169, 169, 0.7)', // íšŒìƒ‰
        'ìˆ˜ì¹˜': 'rgba(255, 182, 193, 0.7)', // ë¶„í™ ê³„ì—´ (ìƒˆë¡œ ì¶”ê°€ëœ ê°ì •)
        'ì¤‘ë¦½': 'rgba(220, 220, 220, 0.7)', // ì—°í•œ íšŒìƒ‰ (ìƒˆë¡œ ì¶”ê°€ëœ ê°ì •)
        // í•„ìš”í•œ ë‹¤ë¥¸ ê°ì • ìƒ‰ìƒ ì¶”ê°€
       };

       const labels = Object.keys(emotionCounts);
       const data = Object.values(emotionCounts);
       const backgroundColors = labels.map(label => emotionColors[label] || 'rgba(201, 203, 207, 0.7)'); // ë§¤í•‘ë˜ì§€ ì•Šì€ ê°ì •ì€ ê¸°ë³¸ íšŒìƒ‰

       new Chart(ctx, {
        type: 'bar', // ë˜ëŠ” 'doughnut', 'pie' ë“± ë‹¤ë¥¸ ì°¨íŠ¸ íƒ€ì… ê³ ë ¤ ê°€ëŠ¥
        data: {
            labels: labels,
            datasets: [{
                label: 'ë‚˜ì˜ ë§ˆìŒ ì‹ í˜¸ë“±', // ì¢€ ë” ì¹œê·¼í•œ ë ˆì´ë¸”
                data: data,
                backgroundColor: backgroundColors,
                borderColor: backgroundColors.map(color => color.replace('0.7', '1')), // í…Œë‘ë¦¬ëŠ” ì¡°ê¸ˆ ë” ì§„í•˜ê²Œ
                borderWidth: 1
            }]
        },
        options: {
            responsive: true, // ë°˜ì‘í˜• í™œì„±í™” (ìº”ë²„ìŠ¤ í¬ê¸° ìë™ ì¡°ì ˆ)
            maintainAspectRatio: false, // ì´ ì˜µì…˜ì„ falseë¡œ í•˜ê³  ìº”ë²„ìŠ¤ì— ì§ì ‘ í¬ê¸° ì§€ì • ë˜ëŠ” ë¶€ëª¨ divë¡œ ì œì–´
            indexAxis: 'y', // ê°€ë¡œ ë§‰ëŒ€ ì°¨íŠ¸ë¡œ ë³€ê²½í•˜ì—¬ ê°€ë…ì„± í–¥ìƒ (ì„ íƒ ì‚¬í•­)
            scales: {
                x: { // ê°€ë¡œ ë§‰ëŒ€ ì°¨íŠ¸ ì‚¬ìš© ì‹œ xì¶•ì´ ê°’ ì¶•ì´ ë¨
                    beginAtZero: true,
                    ticks: { 
                        precision: 0,
                        color: '#333' // ì¶• ëˆˆê¸ˆ ìƒ‰ìƒ
                    },
                    grid: {
                        color: '#e0e0e0' // ì¶• ê·¸ë¦¬ë“œ ë¼ì¸ ìƒ‰ìƒ
                    }
                },
                y: { // ê°€ë¡œ ë§‰ëŒ€ ì°¨íŠ¸ ì‚¬ìš© ì‹œ yì¶•ì´ ë ˆì´ë¸” ì¶•ì´ ë¨
                    ticks: {
                        color: '#333'
                    },
                    grid: {
                        display: false // yì¶• ê·¸ë¦¬ë“œ ë¼ì¸ì€ ê¹”ë”í•˜ê²Œ ì œê±° ê°€ëŠ¥
                    }
                }
            },
            plugins: {
                legend: {
                    position: 'top', // ë²”ë¡€ ìœ„ì¹˜
                    labels: {
                        color: '#333', // ë²”ë¡€ í…ìŠ¤íŠ¸ ìƒ‰ìƒ
                        font: {
                            family: "'KoPub World Dotum', sans-serif"
                        }
                    }
                },
                tooltip: { // ë§ˆìš°ìŠ¤ ì˜¬ë ¸ì„ ë•Œ ë‚˜ì˜¤ëŠ” íˆ´íŒ
                    titleFont: { family: "'KoPub World Dotum', sans-serif" },
                    bodyFont: { family: "'KoPub World Dotum', sans-serif" }
                }
            }
        }
    });


    </script>
</body>
</html>
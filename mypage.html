<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title id="pageTitle">ë§ˆì´ ë¡œì§€</title>
    <link href="https://fonts.googleapis.com/css2?family=KoPub+World+Dotum:wght@400;700&display=swap" rel="stylesheet"/> 
    <link rel="stylesheet" href="gnb.css"> <style>
        :root {
            --primary-color: #6e8efb;
            --secondary-color: #5a7edf;
            --background-color: #f4f6f8;
            --text-color: #333333;
            --card-bg: #ffffff;
            --gnb-height: 56px;
            --profile-placeholder-bg: #d0d9ff; 
            --light-blue-bg: #eef2f7; /* ë¶„ì„ ìš”ì•½ ë°°ê²½ ë“± */
            --action-button-bg: #6078ea; /* ë¶„ì„ ë³´ê¸° ë²„íŠ¼ */
        }
        body {
            margin: 0;
            padding-top: var(--gnb-height); /* gnb.cssì— ì—†ë‹¤ë©´ í•„ìš” */
            font-family: 'KoPub World Dotum', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        .container { max-width: 800px; margin: 20px auto; padding: 20px; box-sizing: border-box; }
        .page-title { color: var(--primary-color); text-align: center; font-size: 2em; margin-bottom: 30px; font-weight: 700; }
        
        .profile-section { 
            display: grid;
            grid-template-columns: auto 1fr; 
            gap: 20px;
            background-color: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 30px;
            align-items: center;
        }
        .profile-photo-container { display: flex; justify-content: center; align-items: center; }
        .profile-photo-placeholder { width: 100px; height: 100px; border-radius: 50%; background-color: var(--profile-placeholder-bg); display: flex; align-items: center; justify-content: center; font-size: 2em; color: white; font-weight: bold; }
        .profile-photo-placeholder img { width:100%; height:100%; border-radius:50%; object-fit:cover;}

        .profile-details h2 { font-size: 1.5em; color: var(--primary-color); margin-top: 0; margin-bottom: 5px; text-align:left;}
        .profile-details .user-email { font-size: 0.9em; color: #777; margin-bottom:15px; text-align:left;}
        
        .info-grid { 
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .info-card { background-color: var(--card-bg); padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .info-card h2 { font-size: 1.2em; color: var(--primary-color); margin-top: 0; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; text-align:left;}
        
        .info-item { margin-bottom: 10px; font-size: 1em; display: flex; justify-content: space-between; align-items: baseline;}
        .info-item .label { font-weight: bold; color: #555; margin-right: 10px; white-space: nowrap; }
        .info-item .value { color: var(--text-color); text-align: right; word-break: keep-all; }
        
        .neurodiversity-info ul { list-style: none; padding:0; margin:0; text-align:left; }
        .neurodiversity-info li { background-color: #e9eaf6; color: #3f51b5; padding: 6px 10px; border-radius: 15px; font-size: 0.9em; display: inline-block; margin-right: 8px; margin-bottom: 8px;}

        .plans-card ul { list-style: none; padding: 0; text-align: left; }
        .plans-card li { background-color: #eef2f7; padding: 8px 12px; border-radius: 6px; margin-bottom: 8px; font-size: 0.95em; }
        
        .recent-journals-section h2 { /* "ìµœê·¼ì— ë‚˜ëˆˆ ì´ì•¼ê¸°ë“¤" ì œëª© ìŠ¤íƒ€ì¼ */
            text-align: center; 
            font-size: 1.4em; 
            color: var(--primary-color); 
            margin-top: 30px; 
            margin-bottom: 20px; /* ì¹´ë“œì™€ì˜ ê°„ê²© */
            border-bottom: 1px solid #eee; 
            padding-bottom: 10px;
        }
        .recent-journal-card-list { /* ì´ IDë¥¼ ê°€ì§„ divê°€ ì¹´ë“œë“¤ì„ ê°ìŒˆ */
            display: flex; 
            flex-direction: column; 
            gap: 15px; /* ì¹´ë“œ ê°„ê²© */
            margin-bottom: 20px; 
        }

        /* --- ğŸ‘‡ ë„™ì£½í•œ ê°€ë¡œê°€ ë„“ì€ ì¹´ë“œ ìŠ¤íƒ€ì¼ (journal-list2.htmlê³¼ ë™ì¼í•˜ê²Œ) --- */
        .session-card-wide { 
            background-color: var(--card-bg, #ffffff); 
            border-radius: 10px; 
            padding: 15px 20px; 
            box-shadow: 0 1px 4px rgba(0,0,0,0.08); 
            border-left: 4px solid var(--secondary-color, #5a7edf); 
            display: flex; 
            flex-direction: column; 
            cursor: pointer; /* ì¹´ë“œ ì „ì²´ í´ë¦­ ê°€ëŠ¥ ì•”ì‹œ */
            transition: box-shadow 0.2s;
        }
        .session-card-wide:hover {
            box-shadow: 0 3px 8px rgba(0,0,0,0.12);
        }

        .session-card-wide .session-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: flex-start; 
            margin-bottom: 8px; 
            border-bottom: none; 
            padding-bottom: 5px;
        }
        .session-card-wide .session-date { 
            font-size: 0.85em; 
            color: #777; 
            font-weight:normal; 
        }
        .session-card-wide .session-meta { /* íšŒì°¨ ì •ë³´ (í•„ìš”ì‹œ) */
            font-size: 0.85em;
            color: var(--primary-color);
            font-weight: bold;
        }

        .session-card-wide h3 { /* íšŒì°¨ë³„ ì œëª© */
            font-size: 1.1em; 
            color: var(--text-color); 
            margin-top: 0; 
            margin-bottom: 8px; 
            font-weight: 500; 
        }
        .session-card-wide .session-summary { 
            font-size: 0.9em; 
            color: #555; 
            margin-bottom: 10px; 
            white-space: normal; 
            word-break:keep-all; 
            line-height: 1.5;
            display: -webkit-box;
            -webkit-line-clamp: 2; /* 2ì¤„ ë¯¸ë¦¬ë³´ê¸° */
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
            min-height: calc(0.9em * 1.5 * 2); 
            padding-left: 0; 
            border-left: none;
        }
        .session-card-wide .session-analysis-summary { /* ì´ ë¶€ë¶„ì€ mypage ìµœê·¼ ëª©ë¡ì—ì„œëŠ” ìƒëµ ê°€ëŠ¥ */
            display: none; /* mypageì—ì„œëŠ” ì´ ìƒì„¸ ë¶„ì„ ìš”ì•½ì€ ìˆ¨ê¹€ */
        }
        .session-card-wide .analysis-view-button { /* ì´ ë²„íŠ¼ë„ mypageì—ì„œëŠ” ìˆ¨ê¸°ê±°ë‚˜, í´ë¦­ ì‹œ journal.htmlë¡œ ë°”ë¡œ ì´ë™ */
            display: none; /* mypageì—ì„œëŠ” ì´ ë²„íŠ¼ ëŒ€ì‹  ì¹´ë“œ ì „ì²´ í´ë¦­ ì‚¬ìš© */
        }
        /* --- ë„™ì£½í•œ ê°€ë¡œê°€ ë„“ì€ ì¹´ë“œ ìŠ¤íƒ€ì¼ ë --- */
        
        .action-button { display: inline-block; margin-top: 15px; background-color: #6e8efb; color: white; padding: 10px 15px; border: none; border-radius: 8px; cursor: pointer; font-size: 0.9em; transition: background-color 0.2s; }
        .action-button:hover { background-color: #5a7edf; }
        .view-all-journals-btn { display: block; width: fit-content; margin: 20px auto 0 auto; }

        .connection-status { margin-left: 8px; font-size: 0.9em; }
        .connection-status .connected { color: green; font-weight: bold; }
        .connection-status .disconnected { color: #aaa; }
        .module-explanation { font-size:0.9em; color:#555; margin-bottom:15px; padding: 10px; background-color: #eef2f7; border-radius: 6px; line-height: 1.6; text-align: left; }

        @media (max-width: 700px) {
            .profile-section { grid-template-columns: 1fr; text-align: center; }
            .profile-details h2, .profile-details .user-email { text-align: center; }
            .info-item { flex-direction: column; align-items: flex-start; }
            .info-item .value { text-align: left; }
            .info-grid { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>
    <nav id="gnb">
        <div id="gnb-title">LOZEE</div>
        <button id="menu-toggle">â˜°</button>
        <div id="dropdown-menu">
          <a href="mypage.html">ğŸ¨ ë‚´ ì •ë³´ ë³´ê¸°</a> 
          <a href="index.html">âœ¨ ìƒˆë¡œìš´ ì´ì•¼ê¸° ì‹œì‘!</a> 
          <a href="analysis.html">ğŸ“Š ìš°ë¦¬ ì´ì•¼ê¸° ë¶„ì„</a> 
          <a href="journal-list.html">ğŸ“– ì´ì•¼ê¸° ëª¨ìŒì§‘</a> 
          <a href="https://www.notion.so/maenglionworld/lOZEE-1ebbcdc037cd80fa9c0ddef234121e84?pvs=4" target="_blank">â“ ë¡œì§€ ì‚¬ìš© ì„¤ëª…ì„œ</a> 
        </div>
    </nav> 

    <main class="container">
        <h1 id="pageMainTitle" class="page-title">ğŸ¨ ë‚˜ì˜ ë¡œì§€ ë³´ê´€í•¨</h1>

        <div class="profile-section">
            <div class="profile-photo-container">
                <div id="userPhotoPlaceholder" class="profile-photo-placeholder"></div>
            </div>
            <div class="profile-details">
                <h2 id="userNameDisplay">ë¡œë”© ì¤‘...</h2>
                <p id="userEmailDisplay" class="user-email">ë¡œë”© ì¤‘...</p>
                <div class="info-item"><span class="label" id="ageLabel">ë§Œ ë‚˜ì´:</span> <span id="userFullAge" class="value">ë¡œë”© ì¤‘...</span></div>
                <div class="info-item"><span class="label">ë§ˆì§€ë§‰ ì ‘ì†:</span> <span id="lastLoginDate" class="value">ë¡œë”© ì¤‘...</span></div>
                <div class="info-item"><span class="label" id="sessionCountLabel">ë¡œì§€ì™€ì˜ ì´ ëŒ€í™”:</span> <span id="totalSessionsCount" class="value">ë¡œë”© ì¤‘...</span></div>
            </div>
        </div>

        <div class="info-grid">
            <div class="info-card neurodiversity-info" id="directUserDiagnosisCard" style="display:none;">
                <h2>âœ¨ ë‚˜ì˜ íŠ¹ì„± ì´í•´í•˜ê¸°</h2>
                <p class="module-explanation">ë‚´ê°€ ì„ íƒí–ˆë˜ ë‚˜ì˜ íŠ¹ì„±ë“¤ì´ì•¼. ì´ íŠ¹ì„±ë“¤ì€ ë¡œì§€ì™€ì˜ ëŒ€í™”ì— ì°¸ê³ ë  ìˆ˜ ìˆì–´!</p>
                <ul id="userDiagnosesList"><li>ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</li></ul>
            </div>
            
            <div class="info-card neurodiversity-info" id="caregiverPersonalNDCard" style="display:none;">
                <h2>ğŸ™‹â€â™€ï¸ ë³´í˜¸ìë‹˜ íŠ¹ì„± ì´í•´</h2>
                <p class="module-explanation">ë³´í˜¸ìë‹˜ ë˜ëŠ” ë°°ìš°ìë‹˜ì˜ ì‹ ê²½ë‹¤ì–‘ì„± íŠ¹ì„±ì„ ì´í•´í•˜ëŠ” ê²ƒì€ ì–‘ìœ¡ê³¼ ê´€ê³„ì— ì¤‘ìš”í•œ ì²«ê±¸ìŒì´ ë  ìˆ˜ ìˆì–´ìš”.</p>
                <ul id="caregiverPersonalNeurodiversityList"><li>ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</li></ul>
            </div>

            <div class="info-card child-info-card" id="childInfoCard" style="display:none;">
                <h2>ğŸ§¸ ì•„ì´/ê°€ì¡± ì •ë³´</h2>
                <p class="info-item"><span class="label">ì´ë¦„:</span> <span id="childNameDisplay" class="value">ë¡œë”© ì¤‘...</span></p>
                <p class="info-item"><span class="label">ë§Œ ë‚˜ì´:</span> <span id="childFullAge" class="value">ë¡œë”© ì¤‘...</span></p>
                <p class="info-item"><span class="label">íŠ¹ì„± ì´í•´:</span></p>
                <ul id="childDiagnosesList" style="margin-top: -5px; margin-bottom:10px; text-align:left;"><li>ì •ë³´ ì—†ìŒ</li></ul>
                <p class="info-item" style="margin-top:15px;">
                    <span class="label">ì—°ê²°ëœ ë¡œì§€ ê³„ì •:</span> 
                    <span id="childLozeeEmailDisplay" class="value">ì •ë³´ ì—†ìŒ</span>
                    <span id="childConnectionStatus" class="connection-status"></span>
                </p>
            </div>
            
            <div class="info-card plans-card">
                <h2>ğŸ¤ ë¡œì§€ì™€ì˜ ì•½ì†! (ë¡œì§€ ìˆ™ì œ)</h2>
                <p class="module-explanation">ë¡œì§€ë‘ ì´ëŸ° ì´ì•¼ê¸°ë¥¼ ë” ë‚˜ëˆ„ê¸°ë¡œ í–ˆì—ˆì§€! ì–¸ì œë“  ë‹¤ì‹œ ì‹œì‘í•  ìˆ˜ ìˆì–´.</p>
                <ul id="lozeePlans"></ul>
            </div>
        </div>

        <div class="section recent-journals-section">
            <h2 class="recent-journals-title">ğŸ’¬ ìµœê·¼ì— ë‚˜ëˆˆ ì´ì•¼ê¸°ë“¤ (ìµœì‹  10ê°œ)</h2>
            <div id="recentJournalCardList" class="recent-journal-card-list">
                </div>
            <button id="goToJournalListBtn" class="action-button view-all-journals-btn">ğŸ“– ì „ì²´ ì´ì•¼ê¸° ëª¨ìŒì§‘ ê°€ê¸°</button>
        </div>
    </main>

    <script src="./js/gnb.js" defer></script> 
    <script type="module">
        import { db } from './js/firebase-config.js';
        import { doc, getDoc, collection, query, where, getDocs, orderBy, limit } from 'https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js';

        // --- DOM ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° (ì´ì „ê³¼ ë™ì¼) ---
const pageMainTitleEl = document.getElementById('pageMainTitle');
    const pageTitleEl = document.querySelector('title');
    const userPhotoPlaceholderEl = document.getElementById('userPhotoPlaceholder');
    const userNameDisplayEl = document.getElementById('userNameDisplay');
    const userEmailDisplayEl = document.getElementById('userEmailDisplay');
    const ageLabelEl = document.getElementById('ageLabel');
    const userFullAgeEl = document.getElementById('userFullAge');
    const lastLoginDateEl = document.getElementById('lastLoginDate');
    const sessionCountLabelEl = document.getElementById('sessionCountLabel');
    const totalSessionsCountEl = document.getElementById('totalSessionsCount');
    
    const directUserDiagnosisCardEl = document.getElementById('directUserDiagnosisCard');
    const userDiagnosesListEl = document.getElementById('userDiagnosesList');
    
    const caregiverPersonalNDCardEl = document.getElementById('caregiverPersonalNDCard');
    const caregiverPersonalNeurodiversityListEl = document.getElementById('caregiverPersonalNeurodiversityList');
    
    const childInfoCardEl = document.getElementById('childInfoCard');
    const childNameDisplayEl = document.getElementById('childNameDisplay');
    const childFullAgeEl = document.getElementById('childFullAge');
    const childDiagnosesListEl = document.getElementById('childDiagnosesList');
    const childLozeeEmailDisplayEl = document.getElementById('childLozeeEmailDisplay');
    const childConnectionStatusEl = document.getElementById('childConnectionStatus');
    
    const lozeePlansEl = document.getElementById('lozeePlans');
    const recentJournalCardListEl = document.getElementById('recentJournalCardList');
    const goToJournalListBtn = document.getElementById('goToJournalListBtn');


        // --- í—¬í¼ í•¨ìˆ˜ (calculateAgeFromBirthDate, getNeurodiversityText - ì´ì „ê³¼ ë™ì¼) ---
        function calculateAgeFromBirthDate(birthDateStr) { /* ... */ }
        function getNeurodiversityText(code) { /* ... */ }

        // --- ì‚¬ìš©ì í”„ë¡œí•„ ë¡œë“œ ë° í‘œì‹œ (loadUserProfile - ì´ì „ê³¼ ë™ì¼) ---
        async function loadUserProfile() { /* ... ì´ì „ ìµœì¢…ë³¸ ì½”ë“œ ... */ }
        
        // --- LOZEEì™€ì˜ ì•½ì† í‘œì‹œ í•¨ìˆ˜ (displayLozeePlans - ì´ì „ê³¼ ë™ì¼) ---
        function displayLozeePlans() { /* ... ì´ì „ ìµœì¢…ë³¸ ì½”ë“œ ... */ }

        // --- âœ¨ ìµœê·¼ ì €ë„ 10ê°œ Firestoreì—ì„œ ë¡œë“œ ë° ìƒˆ ì¹´ë“œ ìŠ¤íƒ€ì¼ë¡œ í‘œì‹œ (ìˆ˜ì •ë¨) âœ¨ ---
        async function displayRecentJournals() {
            if (!recentJournalCardListEl) return;
            recentJournalCardListEl.innerHTML = ''; 

            const loggedInUserEmail = localStorage.getItem('cbtUserEmail');
            const userType = localStorage.getItem('lozee_userType');
            let targetUserIdForJournals = loggedInUserEmail; 

            if (userType === 'caregiver') {
                const childEmail = localStorage.getItem('lozee_child_email');
                if (childEmail) { 
                    targetUserIdForJournals = childEmail;
                } else { 
                    recentJournalCardListEl.innerHTML = '<p style="text-align:center; color:#777; padding: 20px 0;">ì•„ì´/ê°€ì¡±ì˜ ë¡œì§€ ê³„ì •ì´ ì—°ê²°ë˜ë©´ ìµœê·¼ ëŒ€í™”ë¥¼ ë³¼ ìˆ˜ ìˆì–´ìš”.</p>';
                    return;
                }
            }

            if (!targetUserIdForJournals) {
                recentJournalCardListEl.innerHTML = '<p style="text-align:center; color:#777; padding: 20px 0;">ìµœê·¼ ëŒ€í™”ë¥¼ ë¶ˆëŸ¬ì˜¬ ì‚¬ìš©ì ì •ë³´ê°€ ì—†ì–´ìš”.</p>';
                return;
            }

            try {
                const q = query(
                    collection(db, 'journals'), 
                    where('userId', '==', targetUserIdForJournals), 
                    orderBy('createdAt', 'desc'), 
                    limit(10) 
                );
                const querySnapshot = await getDocs(q);

                if (querySnapshot.empty) {
                    recentJournalCardListEl.innerHTML = `<p style="text-align:center; color:#777; padding: 20px 0;">ì•„ì§ ë¡œì§€ì™€ì˜ ì´ì•¼ê¸°ê°€ ì¶©ë¶„íˆ ìŒ“ì´ì§€ ì•Šì•˜ë‚˜ ë´ìš”. ğŸ¤”</p>`;
                } else {
                    let sessionCounter = querySnapshot.size; // ìµœì‹ ì´ ê°€ì¥ ë†’ì€ íšŒì°¨
                    querySnapshot.forEach((docSnap) => {
                        const journal = docSnap.data();
                        const card = document.createElement('div');
                        card.className = 'session-card-wide'; // ğŸ‘ˆ "ë„™ì£½í•œ ê°€ë¡œê°€ ë„“ì€ ì¹´ë“œ" ìŠ¤íƒ€ì¼ ì ìš©
                        
                        const dateStr = journal.createdAt?.toDate ? journal.createdAt.toDate().toLocaleDateString('ko-KR', {month: 'long', day: 'numeric'}) : 'ë‚ ì§œ ì—†ìŒ';
                        const title = journal.title || journal.topic || 'ì œëª© ì—†ëŠ” ì´ì•¼ê¸°';
                        const summaryPreview = journal.summary ? journal.summary.substring(0, 100) + (journal.summary.length > 100 ? '...' : '') : 'ìš”ì•½ì´ ì—†ì–´ìš”.';
                        
                        // ë¡œì§€ ë¶„ì„ ìš”ì•½ (ê°„ë‹¨í•˜ê²Œ)
                        let lozeeAnalysisHTML = "";
                        if(journal.detailedAnalysis && journal.detailedAnalysis.overallSentiment) {
                            let sentimentText = "";
                            let sentimentClass = "neutral";
                            if (journal.detailedAnalysis.overallSentiment === "positive") { sentimentText = "ê¸ì •ì ì¸ ëŒ€í™”ì˜€ì–´ìš” ğŸ‘"; sentimentClass = "positive"; }
                            else if (journal.detailedAnalysis.overallSentiment === "negative") { sentimentText = "ì¡°ê¸ˆ í˜ë“  ëŒ€í™”ì˜€ë‚˜ë´ìš” ğŸ˜Ÿ"; sentimentClass = "negative"; }
                            else { sentimentText = "ì°¨ë¶„í•œ ëŒ€í™”ì˜€ì–´ìš” ğŸ˜Œ"; }
                            lozeeAnalysisHTML = `<div class="journal-analysis-banner ${sentimentClass}" style="margin-top:10px; margin-bottom:0;">ë¡œì§€ ìƒê°: ${sentimentText}</div>`;
                        }


                        card.innerHTML = `
                            <div class="session-header">
                                <span class="session-date">${dateStr}</span>
                                <span class="session-meta">${sessionCounter}íšŒì°¨</span> 
                            </div>
                            <h3>${title}</h3>
                            <p class="session-summary">${summaryPreview}</p>
                            ${lozeeAnalysisHTML} 
                            `;
                        
                        // ì¹´ë“œ ì „ì²´ í´ë¦­ ì‹œ journal.html (ì„¸ì…˜ ìƒì„¸ ë° ë¶„ì„ í˜ì´ì§€)ë¡œ ì´ë™
                        card.onclick = () => { 
                            localStorage.setItem('lozee_selected_journal_id', docSnap.id); 
                            // journal.htmlì—ì„œ ì‚¬ìš©í•  ë‹¤ë¥¸ ì •ë³´ë“¤ë„ localStorageì— ì €ì¥ ê°€ëŠ¥
                            localStorage.setItem('lozee_conversation_analysis', JSON.stringify({
                                results: journal.detailedAnalysis || {},
                                accumulatedDurationMinutes: journal.sessionDurationMinutes || 0,
                                accumulatedUserCharCount: journal.userCharCountForThisSession || 0, // ì´ í•„ë“œê°€ journals ë¬¸ì„œì— ìˆë‹¤ë©´
                                journalId: docSnap.id,
                                journalTitle: title, // journal.html ìƒë‹¨ ì œëª©ìš©
                                journalDate: dateStr,  // journal.html ìƒë‹¨ ë‚ ì§œìš©
                                journalSummaryFull: journal.summary // journal.html ìƒì„¸ ìš”ì•½ìš©
                            }));
                            window.location.href = `journal.html?journalId=${docSnap.id}`; 
                        };
                        recentJournalCardListEl.appendChild(card);
                        sessionCounter--; // ë‹¤ìŒ ì¹´ë“œëŠ” ì´ì „ íšŒì°¨
                    });
                }
            } catch (error) { 
                console.error("ìµœê·¼ ì €ë„ ë¡œë“œ ì¤‘ ì˜¤ë¥˜:", error);
                recentJournalCardListEl.innerHTML = '<p style="text-align:center; color:red; padding: 20px 0;">ìµœê·¼ ëŒ€í™”ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ë¬¸ì œê°€ ìƒê²¼ì–´ìš”. ğŸ˜¥</p>';
            }
        }

        // "ì´ì•¼ê¸° ëª¨ìŒì§‘ ê°€ê¸°" ë²„íŠ¼ ì´ë²¤íŠ¸
        if(goToJournalListBtn) {
            goToJournalListBtn.onclick = () => {
                window.location.href = 'journal-list.html';
            };
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', () => {
            console.log("Mypage: DOMContentLoaded");
            loadUserProfile();
            displayLozeePlans(); 
            displayRecentJournals(); 
        })
    </script>
</body>
</html>